=arrayify(n);if(t.length>32)throw new Error("internal; should not happen");const u=new Uint8Array(32);return u.set(t,32-t.length),u}function bytesPad(n){if(n.length%32===0)return n;const t=new Uint8Array(Math.ceil(n.length/32)*32);return t.set(n),t}function encodeBytes(n){const t=[];let u=0;for(let c=0;c<n.length;c++)t.push(null),u+=32;for(let c=0;c<n.length;c++){const ee=arrayify(n[c]);t[c]=numPad(u),t.push(numPad(ee.length)),t.push(bytesPad(ee)),u+=32+Math.ceil(ee.length/32)*32}return hexConcat(t)}class Resolver{constructor(t,u,c,ee){defineReadOnly(this,"provider",t),defineReadOnly(this,"name",c),defineReadOnly(this,"address",t.formatter.address(u)),defineReadOnly(this,"_resolvedAddress",ee)}supportsWildcard(){return this._supportsEip2544||(this._supportsEip2544=this.provider.call({to:this.address,data:"0x01ffc9a79061b92300000000000000000000000000000000000000000000000000000000"}).then(t=>BigNumber.from(t).eq(1)).catch(t=>{if(t.code===Logger.errors.CALL_EXCEPTION)return!1;throw this._supportsEip2544=null,t})),this._supportsEip2544}_fetch(t,u){return __awaiter$6(this,void 0,void 0,function*(){const c={to:this.address,ccipReadEnabled:!0,data:hexConcat([t,namehash$2(this.name),u||"0x"])};let ee=!1;(yield this.supportsWildcard())&&(ee=!0,c.data=hexConcat(["0x9061b923",encodeBytes([dnsEncode(this.name),c.data])]));try{let te=yield this.provider.call(c);return arrayify(te).length%32===4&&logger$g.throwError("resolver threw error",Logger.errors.CALL_EXCEPTION,{transaction:c,data:te}),ee&&(te=_parseBytes(te,0)),te}catch(te){if(te.code===Logger.errors.CALL_EXCEPTION)return null;throw te}})}_fetchBytes(t,u){return __awaiter$6(this,void 0,void 0,function*(){const c=yield this._fetch(t,u);return c!=null?_parseBytes(c,0):null})}_getAddress(t,u){const c=coinInfos[String(t)];if(c==null&&logger$g.throwError(`unsupported coin type: ${t}`,Logger.errors.UNSUPPORTED_OPERATION,{operation:`getAddress(${t})`}),c.ilk==="eth")return this.provider.formatter.address(u);const ee=arrayify(u);if(c.p2pkh!=null){const te=u.match(/^0x76a9([0-9a-f][0-9a-f])([0-9a-f]*)88ac$/);if(te){const ae=parseInt(te[1],16);if(te[2].length===ae*2&&ae>=1&&ae<=75)return base58Encode(concat$4([[c.p2pkh],"0x"+te[2]]))}}if(c.p2sh!=null){const te=u.match(/^0xa9([0-9a-f][0-9a-f])([0-9a-f]*)87$/);if(te){const ae=parseInt(te[1],16);if(te[2].length===ae*2&&ae>=1&&ae<=75)return base58Encode(concat$4([[c.p2sh],"0x"+te[2]]))}}if(c.prefix!=null){const te=ee[1];let ae=ee[0];if(ae===0?te!==20&&te!==32&&(ae=-1):ae=-1,ae>=0&&ee.length===2+te&&te>=1&&te<=75){const ne=bech32.toWords(ee.slice(2));return ne.unshift(ae),bech32.encode(c.prefix,ne)}}return null}getAddress(t){return __awaiter$6(this,void 0,void 0,function*(){if(t==null&&(t=60),t===60)try{const ee=yield this._fetch("0x3b3b57de");return ee==="0x"||ee===HashZero?null:this.provider.formatter.callAddress(ee)}catch(ee){if(ee.code===Logger.errors.CALL_EXCEPTION)return null;throw ee}const u=yield this._fetchBytes("0xf1cb7e06",bytes32ify(t));if(u==null||u==="0x")return null;const c=this._getAddress(t,u);return c==null&&logger$g.throwError("invalid or unsupported coin data",Logger.errors.UNSUPPORTED_OPERATION,{operation:`getAddress(${t})`,coinType:t,data:u}),c})}getAvatar(){return __awaiter$6(this,void 0,void 0,function*(){const t=[{type:"name",content:this.name}];try{const u=yield this.getText("avatar");if(u==null)return null;for(let c=0;c<matchers.length;c++){const ee=u.match(matchers[c]);if(ee==null)continue;const te=ee[1].toLowerCase();switch(te){case"https":return t.push({type:"url",content:u}),{linkage:t,url:u};case"data":return t.push({type:"data",content:u}),{linkage:t,url:u};case"ipfs":return t.push({type:"ipfs",content:u}),{linkage:t,url:getIpfsLink(u)};case"erc721":case"erc1155":{const ae=te==="erc721"?"0xc87b56dd":"0x0e89341c";t.push({type:te,content:u});const ne=this._resolvedAddress||(yield this.getAddress()),oe=(ee[2]||"").split("/");if(oe.length!==2)return null;const ie=yield this.provider.formatter.address(oe[0]),se=hexZeroPad(BigNumber.from(oe[1]).toHexString(),32);if(te==="erc721"){const fe=this.provider.formatter.callAddress(yield this.provider.call({to:ie,data:hexConcat(["0x6352211e",se])}));if(ne!==fe)return null;t.push({type:"owner",content:fe})}else if(te==="erc1155"){const fe=BigNumber.from(yield this.provider.call({to:ie,data:hexConcat(["0x00fdd58e",hexZeroPad(ne,32),se])}));if(fe.isZero())return null;t.push({type:"balance",content:fe.toString()})}const ue={to:this.provider.formatter.address(oe[0]),data:hexConcat([ae,se])};let le=_parseString(yield this.provider.call(ue),0);if(le==null)return null;t.push({type:"metadata-url-base",content:le}),te==="erc1155"&&(le=le.replace("{id}",se.substring(2)),t.push({type:"metadata-url-expanded",content:le})),le.match(/^ipfs:/i)&&(le=getIpfsLink(le)),t.push({type:"metadata-url",content:le});const ce=yield fetchJson(le);if(!ce)return null;t.push({type:"metadata",content:JSON.stringify(ce)});let de=ce.image;if(typeof de!="string")return null;if(!de.match(/^(https:\/\/|data:)/i)){if(de.match(matcherIpfs)==null)return null;t.push({type:"url-ipfs",content:de}),de=getIpfsLink(de)}return t.push({type:"url",content:de}),{linkage:t,url:de}}}}}catch{}return null})}getContentHash(){return __awaiter$6(this,void 0,void 0,function*(){const t=yield this._fetchBytes("0xbc1c58d1");if(t==null||t==="0x")return null;const u=t.match(/^0xe3010170(([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f]*))$/);if(u){const ae=parseInt(u[3],16);if(u[4].length===ae*2)return"ipfs://"+Base58.encode("0x"+u[1])}const c=t.match(/^0xe5010172(([0-9a-f][0-9a-f])([0-9a-f][0-9a-f])([0-9a-f]*))$/);if(c){const ae=parseInt(c[3],16);if(c[4].length===ae*2)return"ipns://"+Base58.encode("0x"+c[1])}const ee=t.match(/^0xe40101fa011b20([0-9a-f]*)$/);if(ee&&ee[1].length===32*2)return"bzz://"+ee[1];const te=t.match(/^0x90b2c605([0-9a-f]*)$/);if(te&&te[1].length===34*2){const ae={"=":"","+":"-","/":"_"};return"sia://"+encode$1("0x"+te[1]).replace(/[=+\/]/g,oe=>ae[oe])}return logger$g.throwError("invalid or unsupported content hash data",Logger.errors.UNSUPPORTED_OPERATION,{operation:"getContentHash()",data:t})})}getText(t){return __awaiter$6(this,void 0,void 0,function*(){let u=toUtf8Bytes(t);u=concat$4([bytes32ify(64),bytes32ify(u.length),u]),u.length%32!==0&&(u=concat$4([u,hexZeroPad("0x",32-t.length%32)]));const c=yield this._fetchBytes("0x59d1d43c",hexlify(u));return c==null||c==="0x"?null:toUtf8String(c)})}}let defaultFormatter=null,nextPollId=1;class BaseProvider extends Provider{constructor(t){if(super(),this._events=[],this._emitted={block:-2},this.disableCcipRead=!1,this.formatter=new.target.getFormatter(),defineReadOnly(this,"anyNetwork",t==="any"),this.anyNetwork&&(t=this.detectNetwork()),t instanceof Promise)this._networkPromise=t,t.catch(u=>{}),this._ready().catch(u=>{});else{const u=getStatic(new.target,"getNetwork")(t);u?(defineReadOnly(this,"_network",u),this.emit("network",u,null)):logger$g.throwArgumentError("invalid network","network",t)}this._maxInternalBlockNumber=-1024,this._lastBlockNumber=-2,this._maxFilterBlockRange=10,this._pollingInterval=4e3,this._fastQueryDate=0}_ready(){return __awaiter$6(this,void 0,void 0,function*(){if(this._network==null){let t=null;if(this._networkPromise)try{t=yield this._networkPromise}catch{}t==null&&(t=yield this.detectNetwork()),t||logger$g.throwError("no network detected",Logger.errors.UNKNOWN_ERROR,{}),this._network==null&&(this.anyNetwork?this._network=t:defineReadOnly(this,"_network",t),this.emit("network",t,null))}return this._network})}get ready(){return poll(()=>this._ready().then(t=>t,t=>{if(!(t.code===Logger.errors.NETWORK_ERROR&&t.event==="noNetwork"))throw t}))}static getFormatter(){return defaultFormatter==null&&(defaultFormatter=new Formatter),defaultFormatter}static getNetwork(t){return getNetwork(t??"homestead")}ccipReadFetch(t,u,c){return __awaiter$6(this,void 0,void 0,function*(){if(this.disableCcipRead||c.length===0)return null;const ee=t.to.toLowerCase(),te=u.toLowerCase(),ae=[];for(let ne=0;ne<c.length;ne++){const oe=c[ne],ie=oe.replace("{sender}",ee).replace("{data}",te),se=oe.indexOf("{data}")>=0?null:JSON.stringify({data:te,sender:ee}),ue=yield fetchJson({url:ie,errorPassThrough:!0},se,(ce,de)=>(ce.status=de.statusCode,ce));if(ue.data)return ue.data;const le=ue.message||"unknown error";if(ue.status>=400&&ue.status<500)return logger$g.throwError(`response not found during CCIP fetch: ${le}`,Logger.errors.SERVER_ERROR,{url:oe,errorMessage:le});ae.push(le)}return logger$g.throwError(`error encountered during CCIP fetch: ${ae.map(ne=>JSON.stringify(ne)).join(", ")}`,Logger.errors.SERVER_ERROR,{urls:c,errorMessages:ae})})}_getInternalBlockNumber(t){return __awaiter$6(this,void 0,void 0,function*(){if(yield this._ready(),t>0)for(;this._internalBlockNumber;){const ee=this._internalBlockNumber;try{const te=yield ee;if(getTime()-te.respTime<=t)return te.blockNumber;break}catch{if(this._internalBlockNumber===ee)break}}const u=getTime(),c=resolveProperties({blockNumber:this.perform("getBlockNumber",{}),networkError:this.getNetwork().then(ee=>null,ee=>ee)}).then(({blockNumber:ee,networkError:te})=>{if(te)throw this._internalBlockNumber===c&&(this._internalBlockNumber=null),te;const ae=getTime();return ee=BigNumber.from(ee).toNumber(),ee<this._maxInternalBlockNumber&&(ee=this._maxInternalBlockNumber),this._maxInternalBlockNumber=ee,this._setFastBlockNumber(ee),{blockNumber:ee,reqTime:u,respTime:ae}});return this._internalBlockNumber=c,c.catch(ee=>{this._internalBlockNumber===c&&(this._internalBlockNumber=null)}),(yield c).blockNumber})}poll(){return __awaiter$6(this,void 0,void 0,function*(){const t=nextPollId++,u=[];let c=null;try{c=yield this._getInternalBlockNumber(100+this.pollingInterval/2)}catch(ee){this.emit("error",ee);return}if(this._setFastBlockNumber(c),this.emit("poll",t,c),c===this._lastBlockNumber){this.emit("didPoll",t);return}if(this._emitted.block===-2&&(this._emitted.block=c-1),Math.abs(this._emitted.block-c)>1e3)logger$g.warn(`network block skew detected; skipping block events (emitted=${this._emitted.block} blockNumber${c})`),this.emit("error",logger$g.makeError("network block skew detected",Logger.errors.NETWORK_ERROR,{blockNumber:c,event:"blockSkew",previousBlockNumber:this._emitted.block})),this.emit("block",c);else for(let ee=this._emitted.block+1;ee<=c;ee++)this.emit("block",ee);this._emitted.block!==c&&(this._emitted.block=c,Object.keys(this._emitted).forEach(ee=>{if(ee==="block")return;const te=this._emitted[ee];te!=="pending"&&c-te>12&&delete this._emitted[ee]})),this._lastBlockNumber===-2&&(this._lastBlockNumber=c-1),this._events.forEach(ee=>{switch(ee.type){case"tx":{const te=ee.hash;let ae=this.getTransactionReceipt(te).then(ne=>(!ne||ne.blockNumber==null||(this._emitted["t:"+te]=ne.blockNumber,this.emit(te,ne)),null)).catch(ne=>{this.emit("error",ne)});u.push(ae);break}case"filter":{if(!ee._inflight){ee._inflight=!0,ee._lastBlockNumber===-2&&(ee._lastBlockNumber=c-1);const te=ee.filter;te.fromBlock=ee._lastBlockNumber+1,te.toBlock=c;const ae=te.toBlock-this._maxFilterBlockRange;ae>te.fromBlock&&(te.fromBlock=ae),te.fromBlock<0&&(te.fromBlock=0);const ne=this.getLogs(te).then(oe=>{ee._inflight=!1,oe.length!==0&&oe.forEach(ie=>{ie.blockNumber>ee._lastBlockNumber&&(ee._lastBlockNumber=ie.blockNumber),this._emitted["b:"+ie.blockHash]=ie.blockNumber,this._emitted["t:"+ie.transactionHash]=ie.blockNumber,this.emit(te,ie)})}).catch(oe=>{this.emit("error",oe),ee._inflight=!1});u.push(ne)}break}}}),this._lastBlockNumber=c,Promise.all(u).then(()=>{this.emit("didPoll",t)}).catch(ee=>{this.emit("error",ee)})})}resetEventsBlock(t){this._lastBlockNumber=t-1,this.polling&&this.poll()}get network(){return this._network}detectNetwork(){return __awaiter$6(this,void 0,void 0,function*(){return logger$g.throwError("provider does not support network detection",Logger.errors.UNSUPPORTED_OPERATION,{operation:"provider.detectNetwork"})})}getNetwork(){return __awaiter$6(this,void 0,void 0,function*(){const t=yield this._ready(),u=yield this.detectNetwork();if(t.chainId!==u.chainId){if(this.anyNetwork)return this._network=u,this._lastBlockNumber=-2,this._fastBlockNumber=null,this._fastBlockNumberPromise=null,this._fastQueryDate=0,this._emitted.block=-2,this._maxInternalBlockNumber=-1024,this._internalBlockNumber=null,this.emit("network",u,t),yield stall$1(0),this._network;const c=logger$g.makeError("underlying network changed",Logger.errors.NETWORK_ERROR,{event:"changed",network:t,detectedNetwork:u});throw this.emit("error",c),c}return t})}get blockNumber(){return this._getInternalBlockNumber(100+this.pollingInterval/2).then(t=>{this._setFastBlockNumber(t)},t=>{}),this._fastBlockNumber!=null?this._fastBlockNumber:-1}get polling(){return this._poller!=null}set polling(t){t&&!this._poller?(this._poller=setInterval(()=>{this.poll()},this.pollingInterval),this._bootstrapPoll||(this._bootstrapPoll=setTimeout(()=>{this.poll(),this._bootstrapPoll=setTimeout(()=>{this._poller||this.poll(),this._bootstrapPoll=null},this.pollingInterval)},0))):!t&&this._poller&&(clearInterval(this._poller),this._poller=null)}get pollingInterval(){return this._pollingInterval}set pollingInterval(t){if(typeof t!="number"||t<=0||parseInt(String(t))!=t)throw new Error("invalid polling interval");this._pollingInterval=t,this._poller&&(clearInterval(this._poller),this._poller=setInterval(()=>{this.poll()},this._pollingInterval))}_getFastBlockNumber(){const t=getTime();return t-this._fastQueryDate>2*this._pollingInterval&&(this._fastQueryDate=t,this._fastBlockNumberPromise=this.getBlockNumber().then(u=>((this._fastBlockNumber==null||u>this._fastBlockNumber)&&(this._fastBlockNumber=u),this._fastBlockNumber))),this._fastBlockNumberPromise}_setFastBlockNumber(t){this._fastBlockNumber!=null&&t<this._fastBlockNumber||(this._fastQueryDate=getTime(),(this._fastBlockNumber==null||t>this._fastBlockNumber)&&(this._fastBlockNumber=t,this._fastBlockNumberPromise=Promise.resolve(t)))}waitForTransaction(t,u,c){return __awaiter$6(this,void 0,void 0,function*(){return this._waitForTransaction(t,u??1,c||0,null)})}_waitForTransaction(t,u,c,ee){return __awaiter$6(this,void 0,void 0,function*(){const te=yield this.getTransactionReceipt(t);return(te?te.confirmations:0)>=u?te:new Promise((ae,ne)=>{const oe=[];let ie=!1;const se=function(){return ie?!0:(ie=!0,oe.forEach(le=>{le()}),!1)},ue=le=>{le.confirmations<u||se()||ae(le)};if(this.on(t,ue),oe.push(()=>{this.removeListener(t,ue)}),ee){let le=ee.startBlock,ce=null;const de=fe=>__awaiter$6(this,void 0,void 0,function*(){ie||(yield stall$1(1e3),this.getTransactionCount(ee.from).then(pe=>__awaiter$6(this,void 0,void 0,function*(){if(!ie){if(pe<=ee.nonce)le=fe;else{{const me=yield this.getTransaction(t);if(me&&me.blockNumber!=null)return}for(ce==null&&(ce=le-3,ce<ee.startBlock&&(ce=ee.startBlock));ce<=fe;){if(ie)return;const me=yield this.getBlockWithTransactions(ce);for(let ge=0;ge<me.transactions.length;ge++){const De=me.transactions[ge];if(De.hash===t)return;if(De.from===ee.from&&De.nonce===ee.nonce){if(ie)return;const Ce=yield this.waitForTransaction(De.hash,u);if(se())return;let we="replaced";De.data===ee.data&&De.to===ee.to&&De.value.eq(ee.value)?we="repriced":De.data==="0x"&&De.from===De.to&&De.value.isZero()&&(we="cancelled"),ne(logger$g.makeError("transaction was replaced",Logger.errors.TRANSACTION_REPLACED,{cancelled:we==="replaced"||we==="cancelled",reason:we,replacement:this._wrapTransaction(De),hash:t,receipt:Ce}));return}}ce++}}ie||this.once("block",de)}}),pe=>{ie||this.once("block",de)}))});if(ie)return;this.once("block",de),oe.push(()=>{this.removeListener("block",de)})}if(typeof c=="number"&&c>0){const le=setTimeout(()=>{se()||ne(logger$g.makeError("timeout exceeded",Logger.errors.TIMEOUT,{timeout:c}))},c);le.unref&&le.unref(),oe.push(()=>{clearTimeout(le)})}})})}getBlockNumber(){return __awaiter$6(this,void 0,void 0,function*(){return this._getInternalBlockNumber(0)})}getGasPrice(){return __awaiter$6(this,void 0,void 0,function*(){yield this.getNetwork();const t=yield this.perform("getGasPrice",{});try{return BigNumber.from(t)}catch(u){return logger$g.throwError("bad result from backend",Logger.errors.SERVER_ERROR,{method:"getGasPrice",result:t,error:u})}})}getBalance(t,u){return __awaiter$6(this,void 0,void 0,function*(){yield this.getNetwork();const c=yield resolveProperties({address:this._getAddress(t),blockTag:this._getBlockTag(u)}),ee=yield this.perform("getBalance",c);try{return BigNumber.from(ee)}catch(te){return logger$g.throwError("bad result from backend",Logger.errors.SERVER_ERROR,{method:"getBalance",params:c,result:ee,error:te})}})}getTransactionCount(t,u){return __awaiter$6(this,void 0,void 0,function*(){yield this.getNetwork();const c=yield resolveProperties({address:this._getAddress(t),blockTag:this._getBlockTag(u)}),ee=yield this.perform("getTransactionCount",c);try{return BigNumber.from(ee).toNumber()}catch(te){return logger$g.throwError("bad result from backend",Logger.errors.SERVER_ERROR,{method:"getTransactionCount",params:c,result:ee,error:te})}})}getCode(t,u){return __awaiter$6(this,void 0,void 0,function*(){yield this.getNetwork();const c=yield resolveProperties({address:this._getAddress(t),blockTag:this._getBlockTag(u)}),ee=yield this.perform("getCode",c);try{return hexlify(ee)}catch(te){return logger$g.throwError("bad result from backend",Logger.errors.SERVER_ERROR,{method:"getCode",params:c,result:ee,error:te})}})}getStorageAt(t,u,c){return __awaiter$6(this,void 0,void 0,function*(){yield this.getNetwork();const ee=yield resolveProperties({address:this._getAddress(t),blockTag:this._getBlockTag(c),position:Promise.resolve(u).then(ae=>hexValue(ae))}),te=yield this.perform("getStorageAt",ee);try{return hexlify(te)}catch(ae){return logger$g.throwError("bad result from backend",Logger.errors.SERVER_ERROR,{method:"getStorageAt",params:ee,result:te,error:ae})}})}_wrapTransaction(t,u,c){if(u!=null&&hexDataLength(u)!==32)throw new Error("invalid response - sendTransaction");const ee=t;return u!=null&&t.hash!==u&&logger$g.throwError("Transaction hash mismatch from Provider.sendTransaction.",Logger.errors.UNKNOWN_ERROR,{expectedHash:t.hash,returnedHash:u}),ee.wait=(te,ae)=>__awaiter$6(this,void 0,void 0,function*(){te==null&&(te=1),ae==null&&(ae=0);let ne;te!==0&&c!=null&&(ne={data:t.data,from:t.from,nonce:t.nonce,to:t.to,value:t.value,startBlock:c});const oe=yield this._waitForTransaction(t.hash,te,ae,ne);return oe==null&&te===0?null:(this._emitted["t:"+t.hash]=oe.blockNumber,oe.status===0&&logger$g.throwError("transaction failed",Logger.errors.CALL_EXCEPTION,{transactionHash:t.hash,transaction:t,receipt:oe}),oe)}),ee}sendTransaction(t){return __awaiter$6(this,void 0,void 0,function*(){yield this.getNetwork();const u=yield Promise.resolve(t).then(te=>hexlify(te)),c=this.formatter.transaction(t);c.confirmations==null&&(c.confirmations=0);const ee=yield this._getInternalBlockNumber(100+2*this.pollingInterval);try{const te=yield this.perform("sendTransaction",{signedTransaction:u});return this._wrapTransaction(c,te,ee)}catch(te){throw te.transaction=c,te.transactionHash=c.hash,te}})}_getTransactionRequest(t){return __awaiter$6(this,void 0,void 0,function*(){const u=yield t,c={};return["from","to"].forEach(ee=>{u[ee]!=null&&(c[ee]=Promise.resolve(u[ee]).then(te=>te?this._getAddress(te):null))}),["gasLimit","gasPrice","maxFeePerGas","maxPriorityFeePerGas","value"].forEach(ee=>{u[ee]!=null&&(c[ee]=Promise.resolve(u[ee]).then(te=>te?BigNumber.from(te):null))}),["type"].forEach(ee=>{u[ee]!=null&&(c[ee]=Promise.resolve(u[ee]).then(te=>te??null))}),u.accessList&&(c.accessList=this.formatter.accessList(u.accessList)),["data"].forEach(ee=>{u[ee]!=null&&(c[ee]=Promise.resolve(u[ee]).then(te=>te?hexlify(te):null))}),this.formatter.transactionRequest(yield resolveProperties(c))})}_getFilter(t){return __awaiter$6(this,void 0,void 0,function*(){t=yield t;const u={};return t.address!=null&&(u.address=this._getAddress(t.address)),["blockHash","topics"].forEach(c=>{t[c]!=null&&(u[c]=t[c])}),["fromBlock","toBlock"].forEach(c=>{t[c]!=null&&(u[c]=this._getBlockTag(t[c]))}),this.formatter.filter(yield resolveProperties(u))})}_call(t,u,c){return __awaiter$6(this,void 0,void 0,function*(){c>=MAX_CCIP_REDIRECTS&&logger$g.throwError("CCIP read exceeded maximum redirections",Logger.errors.SERVER_ERROR,{redirects:c,transaction:t});const ee=t.to,te=yield this.perform("call",{transaction:t,blockTag:u});if(c>=0&&u==="latest"&&ee!=null&&te.substring(0,10)==="0x556f1830"&&hexDataLength(te)%32===4)try{const ae=hexDataSlice(te,4),ne=hexDataSlice(ae,0,32);BigNumber.from(ne).eq(ee)||logger$g.throwError("CCIP Read sender did not match",Logger.errors.CALL_EXCEPTION,{name:"OffchainLookup",signature:"OffchainLookup(address,string[],bytes,bytes4,bytes)",transaction:t,data:te});const oe=[],ie=BigNumber.from(hexDataSlice(ae,32,64)).toNumber(),se=BigNumber.from(hexDataSlice(ae,ie,ie+32)).toNumber(),ue=hexDataSlice(ae,ie+32);for(let me=0;me<se;me++){const ge=_parseString(ue,me*32);ge==null&&logger$g.throwError("CCIP Read contained corrupt URL string",Logger.errors.CALL_EXCEPTION,{name:"OffchainLookup",signature:"OffchainLookup(address,string[],bytes,bytes4,bytes)",transaction:t,data:te}),oe.push(ge)}const le=_parseBytes(ae,64);BigNumber.from(hexDataSlice(ae,100,128)).isZero()||logger$g.throwError("CCIP Read callback selector included junk",Logger.errors.CALL_EXCEPTION,{name:"OffchainLookup",signature:"OffchainLookup(address,string[],bytes,bytes4,bytes)",transaction:t,data:te});const ce=hexDataSlice(ae,96,100),de=_parseBytes(ae,128),fe=yield this.ccipReadFetch(t,le,oe);fe==null&&logger$g.throwError("CCIP Read disabled or provided no URLs",Logger.errors.CALL_EXCEPTION,{name:"OffchainLookup",signature:"OffchainLookup(address,string[],bytes,bytes4,bytes)",transaction:t,data:te});const pe={to:ee,data:hexConcat([ce,encodeBytes([fe,de])])};return this._call(pe,u,c+1)}catch(ae){if(ae.code===Logger.errors.SERVER_ERROR)throw ae}try{return hexlify(te)}catch(ae){return logger$g.throwError("bad result from backend",Logger.errors.SERVER_ERROR,{method:"call",params:{transaction:t,blockTag:u},result:te,error:ae})}})}call(t,u){return __awaiter$6(this,void 0,void 0,function*(){yield this.getNetwork();const c=yield resolveProperties({transaction:this._getTransactionRequest(t),blockTag:this._getBlockTag(u),ccipReadEnabled:Promise.resolve(t.ccipReadEnabled)});return this._call(c.transaction,c.blockTag,c.ccipReadEnabled?0:-1)})}estimateGas(t){return __awaiter$6(this,void 0,void 0,function*(){yield this.getNetwork();const u=yield resolveProperties({transaction:this._getTransactionRequest(t)}),c=yield this.perform("estimateGas",u);try{return BigNumber.from(c)}catch(ee){return logger$g.throwError("bad result from backend",Logger.errors.SERVER_ERROR,{method:"estimateGas",params:u,result:c,error:ee})}})}_getAddress(t){return __awaiter$6(this,void 0,void 0,function*(){t=yield t,typeof t!="string"&&logger$g.throwArgumentError("invalid address or ENS name","name",t);const u=yield this.resolveName(t);return u==null&&logger$g.throwError("ENS name not configured",Logger.errors.UNSUPPORTED_OPERATION,{operation:`resolveName(${JSON.stringify(t)})`}),u})}_getBlock(t,u){return __awaiter$6(this,void 0,void 0,function*(){yield this.getNetwork(),t=yield t;let c=-128;const ee={includeTransactions:!!u};if(isHexString(t,32))ee.blockHash=t;else try{ee.blockTag=yield this._getBlockTag(t),isHexString(ee.blockTag)&&(c=parseInt(ee.blockTag.substring(2),16))}catch{logger$g.throwArgumentError("invalid block hash or block tag","blockHashOrBlockTag",t)}return poll(()=>__awaiter$6(this,void 0,void 0,function*(){const te=yield this.perform("getBlock",ee);if(te==null)return ee.blockHash!=null&&this._emitted["b:"+ee.blockHash]==null||ee.blockTag!=null&&c>this._emitted.block?null:void 0;if(u){let ae=null;for(let oe=0;oe<te.transactions.length;oe++){const ie=te.transactions[oe];if(ie.blockNumber==null)ie.confirmations=0;else if(ie.confirmations==null){ae==null&&(ae=yield this._getInternalBlockNumber(100+2*this.pollingInterval));let se=ae-ie.blockNumber+1;se<=0&&(se=1),ie.confirmations=se}}const ne=this.formatter.blockWithTransactions(te);return ne.transactions=ne.transactions.map(oe=>this._wrapTransaction(oe)),ne}return this.formatter.block(te)}),{oncePoll:this})})}getBlock(t){return this._getBlock(t,!1)}getBlockWithTransactions(t){return this._getBlock(t,!0)}getTransaction(t){return __awaiter$6(this,void 0,void 0,function*(){yield this.getNetwork(),t=yield t;const u={transactionHash:this.formatter.hash(t,!0)};return poll(()=>__awaiter$6(this,void 0,void 0,function*(){const c=yield this.perform("getTransaction",u);if(c==null)return this._emitted["t:"+t]==null?null:void 0;const ee=this.formatter.transactionResponse(c);if(ee.blockNumber==null)ee.confirmations=0;else if(ee.confirmations==null){let ae=(yield this._getInternalBlockNumber(100+2*this.pollingInterval))-ee.blockNumber+1;ae<=0&&(ae=1),ee.confirmations=ae}return this._wrapTransaction(ee)}),{oncePoll:this})})}getTransactionReceipt(t){return __awaiter$6(this,void 0,void 0,function*(){yield this.getNetwork(),t=yield t;const u={transactionHash:this.formatter.hash(t,!0)};return poll(()=>__awaiter$6(this,void 0,void 0,function*(){const c=yield this.perform("getTransactionReceipt",u);if(c==null)return this._emitted["t:"+t]==null?null:void 0;if(c.blockHash==null)return;const ee=this.formatter.receipt(c);if(ee.blockNumber==null)ee.confirmations=0;else if(ee.confirmations==null){let ae=(yield this._getInternalBlockNumber(100+2*this.pollingInterval))-ee.blockNumber+1;ae<=0&&(ae=1),ee.confirmations=ae}return ee}),{oncePoll:this})})}getLogs(t){return __awaiter$6(this,void 0,void 0,function*(){yield this.getNetwork();const u=yield resolveProperties({filter:this._getFilter(t)}),c=yield this.perform("getLogs",u);return c.forEach(ee=>{ee.removed==null&&(ee.removed=!1)}),Formatter.arrayOf(this.formatter.filterLog.bind(this.formatter))(c)})}getEtherPrice(){return __awaiter$6(this,void 0,void 0,function*(){return yield this.getNetwork(),this.perform("getEtherPrice",{})})}_getBlockTag(t){return __awaiter$6(this,void 0,void 0,function*(){if(t=yield t,typeof t=="number"&&t<0){t%1&&logger$g.throwArgumentError("invalid BlockTag","blockTag",t);let u=yield this._getInternalBlockNumber(100+2*this.pollingInterval);return u+=t,u<0&&(u=0),this.formatter.blockTag(u)}return this.formatter.blockTag(t)})}getResolver(t){return __awaiter$6(this,void 0,void 0,function*(){let u=t;for(;;){if(u===""||u==="."||t!=="eth"&&u==="eth")return null;const c=yield this._getResolver(u,"getResolver");if(c!=null){const ee=new Resolver(this,c,t);return u!==t&&!(yield ee.supportsWildcard())?null:ee}u=u.split(".").slice(1).join(".")}})}_getResolver(t,u){return __awaiter$6(this,void 0,void 0,function*(){u==null&&(u="ENS");const c=yield this.getNetwork();c.ensAddress||logger$g.throwError("network does not support ENS",Logger.errors.UNSUPPORTED_OPERATION,{operation:u,network:c.name});try{const ee=yield this.call({to:c.ensAddress,data:"0x0178b8bf"+namehash$2(t).substring(2)});return this.formatter.callAddress(ee)}catch{}return null})}resolveName(t){return __awaiter$6(this,void 0,void 0,function*(){t=yield t;try{return Promise.resolve(this.formatter.address(t))}catch(c){if(isHexString(t))throw c}typeof t!="string"&&logger$g.throwArgumentError("invalid ENS name","name",t);const u=yield this.getResolver(t);return u?yield u.getAddress():null})}lookupAddress(t){return __awaiter$6(this,void 0,void 0,function*(){t=yield t,t=this.formatter.address(t);const u=t.substring(2).toLowerCase()+".addr.reverse",c=yield this._getResolver(u,"lookupAddress");if(c==null)return null;const ee=_parseString(yield this.call({to:c,data:"0x691f3431"+namehash$2(u).substring(2)}),0);return(yield this.resolveName(ee))!=t?null:ee})}getAvatar(t){return __awaiter$6(this,void 0,void 0,function*(){let u=null;if(isHexString(t)){const te=this.formatter.address(t).substring(2).toLowerCase()+".addr.reverse",ae=yield this._getResolver(te,"getAvatar");if(!ae)return null;u=new Resolver(this,ae,te);try{const ne=yield u.getAvatar();if(ne)return ne.url}catch(ne){if(ne.code!==Logger.errors.CALL_EXCEPTION)throw ne}try{const ne=_parseString(yield this.call({to:ae,data:"0x691f3431"+namehash$2(te).substring(2)}),0);u=yield this.getResolver(ne)}catch(ne){if(ne.code!==Logger.errors.CALL_EXCEPTION)throw ne;return null}}else if(u=yield this.getResolver(t),!u)return null;const c=yield u.getAvatar();return c==null?null:c.url})}perform(t,u){return logger$g.throwError(t+" not implemented",Logger.errors.NOT_IMPLEMENTED,{operation:t})}_startEvent(t){this.polling=this._events.filter(u=>u.pollable()).length>0}_stopEvent(t){this.polling=this._events.filter(u=>u.pollable()).length>0}_addEventListener(t,u,c){const ee=new Event(getEventTag(t),u,c);return this._events.push(ee),this._startEvent(ee),this}on(t,u){return this._addEventListener(t,u,!1)}once(t,u){return this._addEventListener(t,u,!0)}emit(t,...u){let c=!1,ee=[],te=getEventTag(t);return this._events=this._events.filter(ae=>ae.tag!==te?!0:(setTimeout(()=>{ae.listener.apply(this,u)},0),c=!0,ae.once?(ee.push(ae),!1):!0)),ee.forEach(ae=>{this._stopEvent(ae)}),c}listenerCount(t){if(!t)return this._events.length;let u=getEventTag(t);return this._events.filter(c=>c.tag===u).length}listeners(t){if(t==null)return this._events.map(c=>c.listener);let u=getEventTag(t);return this._events.filter(c=>c.tag===u).map(c=>c.listener)}off(t,u){if(u==null)return this.removeAllListeners(t);const c=[];let ee=!1,te=getEventTag(t);return this._events=this._events.filter(ae=>ae.tag!==te||ae.listener!=u||ee?!0:(ee=!0,c.push(ae),!1)),c.forEach(ae=>{this._stopEvent(ae)}),this}removeAllListeners(t){let u=[];if(t==null)u=this._events,this._events=[];else{const c=getEventTag(t);this._events=this._events.filter(ee=>ee.tag!==c?!0:(u.push(ee),!1))}return u.forEach(c=>{this._stopEvent(c)}),this}}var __awaiter$5=function(n,t,u,c){function ee(te){return te instanceof u?te:new u(function(ae){ae(te)})}return new(u||(u=Promise))(function(te,ae){function ne(se){try{ie(c.next(se))}catch(ue){ae(ue)}}function oe(se){try{ie(c.throw(se))}catch(ue){ae(ue)}}function ie(se){se.done?te(se.value):ee(se.value).then(ne,oe)}ie((c=c.apply(n,t||[])).next())})};const logger$f=new Logger(version$9),errorGas=["call","estimateGas"];function spelunk(n,t){if(n==null)return null;if(typeof n.message=="string"&&n.message.match("reverted")){const u=isHexString(n.data)?n.data:null;if(!t||u)return{message:n.message,data:u}}if(typeof n=="object"){for(const u in n){const c=spelunk(n[u],t);if(c)return c}return null}if(typeof n=="string")try{return spelunk(JSON.parse(n),t)}catch{}return null}function checkError$1(n,t,u){const c=u.transaction||u.signedTransaction;if(n==="call"){const te=spelunk(t,!0);if(te)return te.data;logger$f.throwError("missing revert data in call exception; Transaction reverted without a reason string",Logger.errors.CALL_EXCEPTION,{data:"0x",transaction:c,error:t})}if(n==="estimateGas"){let te=spelunk(t.body,!1);te==null&&(te=spelunk(t,!1)),te&&logger$f.throwError("cannot estimate gas; transaction may fail or may require manual gas limit",Logger.errors.UNPREDICTABLE_GAS_LIMIT,{reason:te.message,method:n,transaction:c,error:t})}let ee=t.message;throw t.code===Logger.errors.SERVER_ERROR&&t.error&&typeof t.error.message=="string"?ee=t.error.message:typeof t.body=="string"?ee=t.body:typeof t.responseText=="string"&&(ee=t.responseText),ee=(ee||"").toLowerCase(),ee.match(/insufficient funds|base fee exceeds gas limit|InsufficientFunds/i)&&logger$f.throwError("insufficient funds for intrinsic transaction cost",Logger.errors.INSUFFICIENT_FUNDS,{error:t,method:n,transaction:c}),ee.match(/nonce (is )?too low/i)&&logger$f.throwError("nonce has already been used",Logger.errors.NONCE_EXPIRED,{error:t,method:n,transaction:c}),ee.match(/replacement transaction underpriced|transaction gas price.*too low/i)&&logger$f.throwError("replacement fee too low",Logger.errors.REPLACEMENT_UNDERPRICED,{error:t,method:n,transaction:c}),ee.match(/only replay-protected/i)&&logger$f.throwError("legacy pre-eip-155 transactions not supported",Logger.errors.UNSUPPORTED_OPERATION,{error:t,method:n,transaction:c}),errorGas.indexOf(n)>=0&&ee.match(/gas required exceeds allowance|always failing transaction|execution reverted|revert/)&&logger$f.throwError("cannot estimate gas; transaction may fail or may require manual gas limit",Logger.errors.UNPREDICTABLE_GAS_LIMIT,{error:t,method:n,transaction:c}),t}function timer(n){return new Promise(function(t){setTimeout(t,n)})}function getResult$1(n){if(n.error){const t=new Error(n.error.message);throw t.code=n.error.code,t.data=n.error.data,t}return n.result}function getLowerCase(n){return n&&n.toLowerCase()}const _constructorGuard={};class JsonRpcSigner extends Signer$1{constructor(t,u,c){if(super(),t!==_constructorGuard)throw new Error("do not call the JsonRpcSigner constructor directly; use provider.getSigner");defineReadOnly(this,"provider",u),c==null&&(c=0),typeof c=="string"?(defineReadOnly(this,"_address",this.provider.formatter.address(c)),defineReadOnly(this,"_index",null)):typeof c=="number"?(defineReadOnly(this,"_index",c),defineReadOnly(this,"_address",null)):logger$f.throwArgumentError("invalid address or index","addressOrIndex",c)}connect(t){return logger$f.throwError("cannot alter JSON-RPC Signer connection",Logger.errors.UNSUPPORTED_OPERATION,{operation:"connect"})}connectUnchecked(){return new UncheckedJsonRpcSigner(_constructorGuard,this.provider,this._address||this._index)}getAddress(){return this._address?Promise.resolve(this._address):this.provider.send("eth_accounts",[]).then(t=>(t.length<=this._index&&logger$f.throwError("unknown account #"+this._index,Logger.errors.UNSUPPORTED_OPERATION,{operation:"getAddress"}),this.provider.formatter.address(t[this._index])))}sendUncheckedTransaction(t){t=shallowCopy(t);const u=this.getAddress().then(c=>(c&&(c=c.toLowerCase()),c));if(t.gasLimit==null){const c=shallowCopy(t);c.from=u,t.gasLimit=this.provider.estimateGas(c)}return t.to!=null&&(t.to=Promise.resolve(t.to).then(c=>__awaiter$5(this,void 0,void 0,function*(){if(c==null)return null;const ee=yield this.provider.resolveName(c);return ee==null&&logger$f.throwArgumentError("provided ENS name resolves to null","tx.to",c),ee}))),resolveProperties({tx:resolveProperties(t),sender:u}).then(({tx:c,sender:ee})=>{c.from!=null?c.from.toLowerCase()!==ee&&logger$f.throwArgumentError("from address mismatch","transaction",t):c.from=ee;const te=this.provider.constructor.hexlifyTransaction(c,{from:!0});return this.provider.send("eth_sendTransaction",[te]).then(ae=>ae,ae=>(typeof ae.message=="string"&&ae.message.match(/user denied/i)&&logger$f.throwError("user rejected transaction",Logger.errors.ACTION_REJECTED,{action:"sendTransaction",transaction:c}),checkError$1("sendTransaction",ae,te)))})}signTransaction(t){return logger$f.throwError("signing transactions is unsupported",Logger.errors.UNSUPPORTED_OPERATION,{operation:"signTransaction"})}sendTransaction(t){return __awaiter$5(this,void 0,void 0,function*(){const u=yield this.provider._getInternalBlockNumber(100+2*this.provider.pollingInterval),c=yield this.sendUncheckedTransaction(t);try{return yield poll(()=>__awaiter$5(this,void 0,void 0,function*(){const ee=yield this.provider.getTransaction(c);if(ee!==null)return this.provider._wrapTransaction(ee,c,u)}),{oncePoll:this.provider})}catch(ee){throw ee.transactionHash=c,ee}})}signMessage(t){return __awaiter$5(this,void 0,void 0,function*(){const u=typeof t=="string"?toUtf8Bytes(t):t,c=yield this.getAddress();try{return yield this.provider.send("personal_sign",[hexlify(u),c.toLowerCase()])}catch(ee){throw typeof ee.message=="string"&&ee.message.match(/user denied/i)&&logger$f.throwError("user rejected signing",Logger.errors.ACTION_REJECTED,{action:"signMessage",from:c,messageData:t}),ee}})}_legacySignMessage(t){return __awaiter$5(this,void 0,void 0,function*(){const u=typeof t=="string"?toUtf8Bytes(t):t,c=yield this.getAddress();try{return yield this.provider.send("eth_sign",[c.toLowerCase(),hexlify(u)])}catch(ee){throw typeof ee.message=="string"&&ee.message.match(/user denied/i)&&logger$f.throwError("user rejected signing",Logger.errors.ACTION_REJECTED,{action:"_legacySignMessage",from:c,messageData:t}),ee}})}_signTypedData(t,u,c){return __awaiter$5(this,void 0,void 0,function*(){const ee=yield TypedDataEncoder.resolveNames(t,u,c,ae=>this.provider.resolveName(ae)),te=yield this.getAddress();try{return yield this.provider.send("eth_signTypedData_v4",[te.toLowerCase(),JSON.stringify(TypedDataEncoder.getPayload(ee.domain,u,ee.value))])}catch(ae){throw typeof ae.message=="string"&&ae.message.match(/user denied/i)&&logger$f.throwError("user rejected signing",Logger.errors.ACTION_REJECTED,{action:"_signTypedData",from:te,messageData:{domain:ee.domain,types:u,value:ee.value}}),ae}})}unlock(t){return __awaiter$5(this,void 0,void 0,function*(){const u=this.provider,c=yield this.getAddress();return u.send("personal_unlockAccount",[c.toLowerCase(),t,null])})}}class UncheckedJsonRpcSigner extends JsonRpcSigner{sendTransaction(t){return this.sendUncheckedTransaction(t).then(u=>({hash:u,nonce:null,gasLimit:null,gasPrice:null,data:null,value:null,chainId:null,confirmations:0,from:null,wait:c=>this.provider.waitForTransaction(u,c)}))}}const allowedTransactionKeys={chainId:!0,data:!0,gasLimit:!0,gasPrice:!0,nonce:!0,to:!0,value:!0,type:!0,accessList:!0,maxFeePerGas:!0,maxPriorityFeePerGas:!0};class JsonRpcProvider extends BaseProvider{constructor(t,u){let c=u;c==null&&(c=new Promise((ee,te)=>{setTimeout(()=>{this.detectNetwork().then(ae=>{ee(ae)},ae=>{te(ae)})},0)})),super(c),t||(t=getStatic(this.constructor,"defaultUrl")()),typeof t=="string"?defineReadOnly(this,"connection",Object.freeze({url:t})):defineReadOnly(this,"connection",Object.freeze(shallowCopy(t))),this._nextId=42}get _cache(){return this._eventLoopCache==null&&(this._eventLoopCache={}),this._eventLoopCache}static defaultUrl(){return"http://localhost:8545"}detectNetwork(){return this._cache.detectNetwork||(this._cache.detectNetwork=this._uncachedDetectNetwork(),setTimeout(()=>{this._cache.detectNetwork=null},0)),this._cache.detectNetwork}_uncachedDetectNetwork(){return __awaiter$5(this,void 0,void 0,function*(){yield timer(0);let t=null;try{t=yield this.send("eth_chainId",[])}catch{try{t=yield this.send("net_version",[])}catch{}}if(t!=null){const u=getStatic(this.constructor,"getNetwork");try{return u(BigNumber.from(t).toNumber())}catch(c){return logger$f.throwError("could not detect network",Logger.errors.NETWORK_ERROR,{chainId:t,event:"invalidNetwork",serverError:c})}}return logger$f.throwError("could not detect network",Logger.errors.NETWORK_ERROR,{event:"noNetwork"})})}getSigner(t){return new JsonRpcSigner(_constructorGuard,this,t)}getUncheckedSigner(t){return this.getSigner(t).connectUnchecked()}listAccounts(){return this.send("eth_accounts",[]).then(t=>t.map(u=>this.formatter.address(u)))}send(t,u){const c={method:t,params:u,id:this._nextId++,jsonrpc:"2.0"};this.emit("debug",{action:"request",request:deepCopy(c),provider:this});const ee=["eth_chainId","eth_blockNumber"].indexOf(t)>=0;if(ee&&this._cache[t])return this._cache[t];const te=fetchJson(this.connection,JSON.stringify(c),getResult$1).then(ae=>(this.emit("debug",{action:"response",request:c,response:ae,provider:this}),ae),ae=>{throw this.emit("debug",{action:"response",error:ae,request:c,provider:this}),ae});return ee&&(this._cache[t]=te,setTimeout(()=>{this._cache[t]=null},0)),te}prepareRequest(t,u){switch(t){case"getBlockNumber":return["eth_blockNumber",[]];case"getGasPrice":return["eth_gasPrice",[]];case"getBalance":return["eth_getBalance",[getLowerCase(u.address),u.blockTag]];case"getTransactionCount":return["eth_getTransactionCount",[getLowerCase(u.address),u.blockTag]];case"getCode":return["eth_getCode",[getLowerCase(u.address),u.blockTag]];case"getStorageAt":return["eth_getStorageAt",[getLowerCase(u.address),hexZeroPad(u.position,32),u.blockTag]];case"sendTransaction":return["eth_sendRawTransaction",[u.signedTransaction]];case"getBlock":return u.blockTag?["eth_getBlockByNumber",[u.blockTag,!!u.includeTransactions]]:u.blockHash?["eth_getBlockByHash",[u.blockHash,!!u.includeTransactions]]:null;case"getTransaction":return["eth_getTransactionByHash",[u.transactionHash]];case"getTransactionReceipt":return["eth_getTransactionReceipt",[u.transactionHash]];case"call":return["eth_call",[getStatic(this.constructor,"hexlifyTransaction")(u.transaction,{from:!0}),u.blockTag]];case"estimateGas":return["eth_estimateGas",[getStatic(this.constructor,"hexlifyTransaction")(u.transaction,{from:!0})]];case"getLogs":return u.filter&&u.filter.address!=null&&(u.filter.address=getLowerCase(u.filter.address)),["eth_getLogs",[u.filter]]}return null}perform(t,u){return __awaiter$5(this,void 0,void 0,function*(){if(t==="call"||t==="estimateGas"){const ee=u.transaction;if(ee&&ee.type!=null&&BigNumber.from(ee.type).isZero()&&ee.maxFeePerGas==null&&ee.maxPriorityFeePerGas==null){const te=yield this.getFeeData();te.maxFeePerGas==null&&te.maxPriorityFeePerGas==null&&(u=shallowCopy(u),u.transaction=shallowCopy(ee),delete u.transaction.type)}}const c=this.prepareRequest(t,u);c==null&&logger$f.throwError(t+" not implemented",Logger.errors.NOT_IMPLEMENTED,{operation:t});try{return yield this.send(c[0],c[1])}catch(ee){return checkError$1(t,ee,u)}})}_startEvent(t){t.tag==="pending"&&this._startPending(),super._startEvent(t)}_startPending(){if(this._pendingFilter!=null)return;const t=this,u=this.send("eth_newPendingTransactionFilter",[]);this._pendingFilter=u,u.then(function(c){function ee(){t.send("eth_getFilterChanges",[c]).then(function(te){if(t._pendingFilter!=u)return null;let ae=Promise.resolve();return te.forEach(function(ne){t._emitted["t:"+ne.toLowerCase()]="pending",ae=ae.then(function(){return t.getTransaction(ne).then(function(oe){return t.emit("pending",oe),null})})}),ae.then(function(){return timer(1e3)})}).then(function(){if(t._pendingFilter!=u){t.send("eth_uninstallFilter",[c]);return}return setTimeout(function(){ee()},0),null}).catch(te=>{})}return ee(),c}).catch(c=>{})}_stopEvent(t){t.tag==="pending"&&this.listenerCount("pending")===0&&(this._pendingFilter=null),super._stopEvent(t)}static hexlifyTransaction(t,u){const c=shallowCopy(allowedTransactionKeys);if(u)for(const te in u)u[te]&&(c[te]=!0);checkProperties(t,c);const ee={};return["chainId","gasLimit","gasPrice","type","maxFeePerGas","maxPriorityFeePerGas","nonce","value"].forEach(function(te){if(t[te]==null)return;const ae=hexValue(BigNumber.from(t[te]));te==="gasLimit"&&(te="gas"),ee[te]=ae}),["from","to","data"].forEach(function(te){t[te]!=null&&(ee[te]=hexlify(t[te]))}),t.accessList&&(ee.accessList=accessListify(t.accessList)),ee}}let WS=null;try{if(WS=WebSocket,WS==null)throw new Error("inject please")}catch{const t=new Logger(version$9);WS=function(){t.throwError("WebSockets not supported in this environment",Logger.errors.UNSUPPORTED_OPERATION,{operation:"new WebSocket()"})}}var __awaiter$4=function(n,t,u,c){function ee(te){return te instanceof u?te:new u(function(ae){ae(te)})}return new(u||(u=Promise))(function(te,ae){function ne(se){try{ie(c.next(se))}catch(ue){ae(ue)}}function oe(se){try{ie(c.throw(se))}catch(ue){ae(ue)}}function ie(se){se.done?te(se.value):ee(se.value).then(ne,oe)}ie((c=c.apply(n,t||[])).next())})};const logger$e=new Logger(version$9);let NextId=1;class WebSocketProvider extends JsonRpcProvider{constructor(t,u){u==="any"&&logger$e.throwError("WebSocketProvider does not support 'any' network yet",Logger.errors.UNSUPPORTED_OPERATION,{operation:"network:any"}),typeof t=="string"?super(t,u):super("_websocket",u),this._pollingInterval=-1,this._wsReady=!1,typeof t=="string"?defineReadOnly(this,"_websocket",new WS(this.connection.url)):defineReadOnly(this,"_websocket",t),defineReadOnly(this,"_requests",{}),defineReadOnly(this,"_subs",{}),defineReadOnly(this,"_subIds",{}),defineReadOnly(this,"_detectNetwork",super.detectNetwork()),this.websocket.onopen=()=>{this._wsReady=!0,Object.keys(this._requests).forEach(ee=>{this.websocket.send(this._requests[ee].payload)})},this.websocket.onmessage=ee=>{const te=ee.data,ae=JSON.parse(te);if(ae.id!=null){const ne=String(ae.id),oe=this._requests[ne];if(delete this._requests[ne],ae.result!==void 0)oe.callback(null,ae.result),this.emit("debug",{action:"response",request:JSON.parse(oe.payload),response:ae.result,provider:this});else{let ie=null;ae.error?(ie=new Error(ae.error.message||"unknown error"),defineReadOnly(ie,"code",ae.error.code||null),defineReadOnly(ie,"response",te)):ie=new Error("unknown error"),oe.callback(ie,void 0),this.emit("debug",{action:"response",error:ie,request:JSON.parse(oe.payload),provider:this})}}else if(ae.method==="eth_subscription"){const ne=this._subs[ae.params.subscription];ne&&ne.processFunc(ae.params.result)}else console.warn("this should not happen")};const c=setInterval(()=>{this.emit("poll")},1e3);c.unref&&c.unref()}get websocket(){return this._websocket}detectNetwork(){return this._detectNetwork}get pollingInterval(){return 0}resetEventsBlock(t){logger$e.throwError("cannot reset events block on WebSocketProvider",Logger.errors.UNSUPPORTED_OPERATION,{operation:"resetEventBlock"})}set pollingInterval(t){logger$e.throwError("cannot set polling interval on WebSocketProvider",Logger.errors.UNSUPPORTED_OPERATION,{operation:"setPollingInterval"})}poll(){return __awaiter$4(this,void 0,void 0,function*(){return null})}set polling(t){t&&logger$e.throwError("cannot set polling on WebSocketProvider",Logger.errors.UNSUPPORTED_OPERATION,{operation:"setPolling"})}send(t,u){const c=NextId++;return new Promise((ee,te)=>{function ae(oe,ie){return oe?te(oe):ee(ie)}const ne=JSON.stringify({method:t,params:u,id:c,jsonrpc:"2.0"});this.emit("debug",{action:"request",request:JSON.parse(ne),provider:this}),this._requests[String(c)]={callback:ae,payload:ne},this._wsReady&&this.websocket.send(ne)})}static defaultUrl(){return"ws://localhost:8546"}_subscribe(t,u,c){return __awaiter$4(this,void 0,void 0,function*(){let ee=this._subIds[t];ee==null&&(ee=Promise.all(u).then(ae=>this.send("eth_subscribe",ae)),this._subIds[t]=ee);const te=yield ee;this._subs[te]={tag:t,processFunc:c}})}_startEvent(t){switch(t.type){case"block":this._subscribe("block",["newHeads"],u=>{const c=BigNumber.from(u.number).toNumber();this._emitted.block=c,this.emit("block",c)});break;case"pending":this._subscribe("pending",["newPendingTransactions"],u=>{this.emit("pending",u)});break;case"filter":this._subscribe(t.tag,["logs",this._getFilter(t.filter)],u=>{u.removed==null&&(u.removed=!1),this.emit(t.filter,this.formatter.filterLog(u))});break;case"tx":{const u=c=>{const ee=c.hash;this.getTransactionReceipt(ee).then(te=>{te&&this.emit(ee,te)})};u(t),this._subscribe("tx",["newHeads"],c=>{this._events.filter(ee=>ee.type==="tx").forEach(u)});break}case"debug":case"poll":case"willPoll":case"didPoll":case"error":break;default:console.log("unhandled:",t);break}}_stopEvent(t){let u=t.tag;if(t.type==="tx"){if(this._events.filter(ee=>ee.type==="tx").length)return;u="tx"}else if(this.listenerCount(t.event))return;const c=this._subIds[u];c&&(delete this._subIds[u],c.then(ee=>{this._subs[ee]&&(delete this._subs[ee],this.send("eth_unsubscribe",[ee]))}))}destroy(){return __awaiter$4(this,void 0,void 0,function*(){this.websocket.readyState===WS.CONNECTING&&(yield new Promise(t=>{this.websocket.onopen=function(){t(!0)},this.websocket.onerror=function(){t(!1)}})),this.websocket.close(1e3)})}}var __awaiter$3=function(n,t,u,c){function ee(te){return te instanceof u?te:new u(function(ae){ae(te)})}return new(u||(u=Promise))(function(te,ae){function ne(se){try{ie(c.next(se))}catch(ue){ae(ue)}}function oe(se){try{ie(c.throw(se))}catch(ue){ae(ue)}}function ie(se){se.done?te(se.value):ee(se.value).then(ne,oe)}ie((c=c.apply(n,t||[])).next())})};const logger$d=new Logger(version$9);class StaticJsonRpcProvider extends JsonRpcProvider{detectNetwork(){const t=Object.create(null,{detectNetwork:{get:()=>super.detectNetwork}});return __awaiter$3(this,void 0,void 0,function*(){let u=this.network;return u==null&&(u=yield t.detectNetwork.call(this),u||logger$d.throwError("no network detected",Logger.errors.UNKNOWN_ERROR,{}),this._network==null&&(defineReadOnly(this,"_network",u),this.emit("network",u,null))),u})}}class UrlJsonRpcProvider extends StaticJsonRpcProvider{constructor(t,u){logger$d.checkAbstract(new.target,UrlJsonRpcProvider),t=getStatic(new.target,"getNetwork")(t),u=getStatic(new.target,"getApiKey")(u);const c=getStatic(new.target,"getUrl")(t,u);super(c,t),typeof u=="string"?defineReadOnly(this,"apiKey",u):u!=null&&Object.keys(u).forEach(ee=>{defineReadOnly(this,ee,u[ee])})}_startPending(){logger$d.warn("WARNING: API provider does not support pending filters")}isCommunityResource(){return!1}getSigner(t){return logger$d.throwError("API provider does not support signing",Logger.errors.UNSUPPORTED_OPERATION,{operation:"getSigner"})}listAccounts(){return Promise.resolve([])}static getApiKey(t){return t}static getUrl(t,u){return logger$d.throwError("not implemented; sub-classes must override getUrl",Logger.errors.NOT_IMPLEMENTED,{operation:"getUrl"})}}const logger$c=new Logger(version$9),defaultApiKey$2="_gg7wSSi0KMBsdKnGVfHDueq6xMB9EkC";class AlchemyWebSocketProvider extends WebSocketProvider{constructor(t,u){const c=new AlchemyProvider(t,u),ee=c.connection.url.replace(/^http/i,"ws").replace(".alchemyapi.",".ws.alchemyapi.");super(ee,c.network),defineReadOnly(this,"apiKey",c.apiKey)}isCommunityResource(){return this.apiKey===defaultApiKey$2}}class AlchemyProvider extends UrlJsonRpcProvider{static getWebSocketProvider(t,u){return new AlchemyWebSocketProvider(t,u)}static getApiKey(t){return t==null?defaultApiKey$2:(t&&typeof t!="string"&&logger$c.throwArgumentError("invalid apiKey","apiKey",t),t)}static getUrl(t,u){let c=null;switch(t.name){case"homestead":c="eth-mainnet.alchemyapi.io/v2/";break;case"goerli":c="eth-goerli.g.alchemy.com/v2/";break;case"matic":c="polygon-mainnet.g.alchemy.com/v2/";break;case"maticmum":c="polygon-mumbai.g.alchemy.com/v2/";break;case"arbitrum":c="arb-mainnet.g.alchemy.com/v2/";break;case"arbitrum-goerli":c="arb-goerli.g.alchemy.com/v2/";break;case"optimism":c="opt-mainnet.g.alchemy.com/v2/";break;case"optimism-goerli":c="opt-goerli.g.alchemy.com/v2/";break;default:logger$c.throwArgumentError("unsupported network","network",arguments[0])}return{allowGzip:!0,url:"https://"+c+u,throttleCallback:(ee,te)=>(u===defaultApiKey$2&&showThrottleMessage(),Promise.resolve(!0))}}isCommunityResource(){return this.apiKey===defaultApiKey$2}}const logger$b=new Logger(version$9),defaultApiKey$1="9f7d929b018cdffb338517efa06f58359e86ff1ffd350bc889738523659e7972";function getHost(n){switch(n){case"homestead":return"rpc.ankr.com/eth/";case"ropsten":return"rpc.ankr.com/eth_ropsten/";case"rinkeby":return"rpc.ankr.com/eth_rinkeby/";case"goerli":return"rpc.ankr.com/eth_goerli/";case"matic":return"rpc.ankr.com/polygon/";case"arbitrum":return"rpc.ankr.com/arbitrum/"}return logger$b.throwArgumentError("unsupported network","name",n)}class AnkrProvider extends UrlJsonRpcProvider{isCommunityResource(){return this.apiKey===defaultApiKey$1}static getApiKey(t){return t??defaultApiKey$1}static getUrl(t,u){u==null&&(u=defaultApiKey$1);const c={allowGzip:!0,url:"https://"+getHost(t.name)+u,throttleCallback:(ee,te)=>(u.apiKey===defaultApiKey$1&&showThrottleMessage(),Promise.resolve(!0))};return u.projectSecret!=null&&(c.user="",c.password=u.projectSecret),c}}var __awaiter$2=function(n,t,u,c){function ee(te){return te instanceof u?te:new u(function(ae){ae(te)})}return new(u||(u=Promise))(function(te,ae){function ne(se){try{ie(c.next(se))}catch(ue){ae(ue)}}function oe(se){try{ie(c.throw(se))}catch(ue){ae(ue)}}function ie(se){se.done?te(se.value):ee(se.value).then(ne,oe)}ie((c=c.apply(n,t||[])).next())})};const logger$a=new Logger(version$9);class CloudflareProvider extends UrlJsonRpcProvider{static getApiKey(t){return t!=null&&logger$a.throwArgumentError("apiKey not supported for cloudflare","apiKey",t),null}static getUrl(t,u){let c=null;switch(t.name){case"homestead":c="https://cloudflare-eth.com/";break;default:logger$a.throwArgumentError("unsupported network","network",arguments[0])}return c}perform(t,u){const c=Object.create(null,{perform:{get:()=>super.perform}});return __awaiter$2(this,void 0,void 0,function*(){return t==="getBlockNumber"?(yield c.perform.call(this,"getBlock",{blockTag:"latest"})).number:c.perform.call(this,t,u)})}}var __awaiter$1=function(n,t,u,c){function ee(te){return te instanceof u?te:new u(function(ae){ae(te)})}return new(u||(u=Promise))(function(te,ae){function ne(se){try{ie(c.next(se))}catch(ue){ae(ue)}}function oe(se){try{ie(c.throw(se))}catch(ue){ae(ue)}}function ie(se){se.done?te(se.value):ee(se.value).then(ne,oe)}ie((c=c.apply(n,t||[])).next())})};const logger$9=new Logger(version$9);function getTransactionPostData(n){const t={};for(let u in n){if(n[u]==null)continue;let c=n[u];u==="type"&&c===0||({type:!0,gasLimit:!0,gasPrice:!0,maxFeePerGs:!0,maxPriorityFeePerGas:!0,nonce:!0,value:!0}[u]?c=hexValue(hexlify(c)):u==="accessList"?c="["+accessListify(c).map(ee=>`{address:"${ee.address}",storageKeys:["${ee.storageKeys.join('","')}"]}`).join(",")+"]":c=hexlify(c),t[u]=c)}return t}function getResult(n){if(n.status==0&&(n.message==="No records found"||n.message==="No transactions found"))return n.result;if(n.status!=1||typeof n.message!="string"||!n.message.match(/^OK/)){const t=new Error("invalid response");throw t.result=JSON.stringify(n),(n.result||"").toLowerCase().indexOf("rate limit")>=0&&(t.throttleRetry=!0),t}return n.result}function getJsonResult(n){if(n&&n.status==0&&n.message=="NOTOK"&&(n.result||"").toLowerCase().indexOf("rate limit")>=0){const t=new Error("throttled response");throw t.result=JSON.stringify(n),t.throttleRetry=!0,t}if(n.jsonrpc!="2.0"){const t=new Error("invalid response");throw t.result=JSON.stringify(n),t}if(n.error){const t=new Error(n.error.message||"unknown error");throw n.error.code&&(t.code=n.error.code),n.error.data&&(t.data=n.error.data),t}return n.result}function checkLogTag(n){if(n==="pending")throw new Error("pending not supported");return n==="latest"?n:parseInt(n.substring(2),16)}function checkError(n,t,u){if(n==="call"&&t.code===Logger.errors.SERVER_ERROR){const ee=t.error;if(ee&&(ee.message.match(/reverted/i)||ee.message.match(/VM execution error/i))){let te=ee.data;if(te&&(te="0x"+te.replace(/^.*0x/i,"")),isHexString(te))return te;logger$9.throwError("missing revert data in call exception",Logger.errors.CALL_EXCEPTION,{error:t,data:"0x"})}}let c=t.message;throw t.code===Logger.errors.SERVER_ERROR&&(t.error&&typeof t.error.message=="string"?c=t.error.message:typeof t.body=="string"?c=t.body:typeof t.responseText=="string"&&(c=t.responseText)),c=(c||"").toLowerCase(),c.match(/insufficient funds/)&&logger$9.throwError("insufficient funds for intrinsic transaction cost",Logger.errors.INSUFFICIENT_FUNDS,{error:t,method:n,transaction:u}),c.match(/same hash was already imported|transaction nonce is too low|nonce too low/)&&logger$9.throwError("nonce has already been used",Logger.errors.NONCE_EXPIRED,{error:t,method:n,transaction:u}),c.match(/another transaction with same nonce/)&&logger$9.throwError("replacement fee too low",Logger.errors.REPLACEMENT_UNDERPRICED,{error:t,method:n,transaction:u}),c.match(/execution failed due to an exception|execution reverted/)&&logger$9.throwError("cannot estimate gas; transaction may fail or may require manual gas limit",Logger.errors.UNPREDICTABLE_GAS_LIMIT,{error:t,method:n,transaction:u}),t}class EtherscanProvider extends BaseProvider{constructor(t,u){super(t),defineReadOnly(this,"baseUrl",this.getBaseUrl()),defineReadOnly(this,"apiKey",u||null)}getBaseUrl(){switch(this.network?this.network.name:"invalid"){case"homestead":return"https://api.etherscan.io";case"goerli":return"https://api-goerli.etherscan.io";case"sepolia":return"https://api-sepolia.etherscan.io";case"matic":return"https://api.polygonscan.com";case"maticmum":return"https://api-testnet.polygonscan.com";case"arbitrum":return"https://api.arbiscan.io";case"arbitrum-goerli":return"https://api-goerli.arbiscan.io";case"optimism":return"https://api-optimistic.etherscan.io";case"optimism-goerli":return"https://api-goerli-optimistic.etherscan.io"}return logger$9.throwArgumentError("unsupported network","network",this.network.name)}getUrl(t,u){const c=Object.keys(u).reduce((te,ae)=>{const ne=u[ae];return ne!=null&&(te+=`&${ae}=${ne}`),te},""),ee=this.apiKey?`&apikey=${this.apiKey}`:"";return`${this.baseUrl}/api?module=${t}${c}${ee}`}getPostUrl(){return`${this.baseUrl}/api`}getPostData(t,u){return u.module=t,u.apikey=this.apiKey,u}fetch(t,u,c){return __awaiter$1(this,void 0,void 0,function*(){const ee=c?this.getPostUrl():this.getUrl(t,u),te=c?this.getPostData(t,u):null,ae=t==="proxy"?getJsonResult:getResult;this.emit("debug",{action:"request",request:ee,provider:this});const ne={url:ee,throttleSlotInterval:1e3,throttleCallback:(se,ue)=>(this.isCommunityResource()&&showThrottleMessage(),Promise.resolve(!0))};let oe=null;te&&(ne.headers={"content-type":"application/x-www-form-urlencoded; charset=UTF-8"},oe=Object.keys(te).map(se=>`${se}=${te[se]}`).join("&"));const ie=yield fetchJson(ne,oe,ae||getJsonResult);return this.emit("debug",{action:"response",request:ee,response:deepCopy(ie),provider:this}),ie})}detectNetwork(){return __awaiter$1(this,void 0,void 0,function*(){return this.network})}perform(t,u){const c=Object.create(null,{perform:{get:()=>super.perform}});return __awaiter$1(this,void 0,void 0,function*(){switch(t){case"getBlockNumber":return this.fetch("proxy",{action:"eth_blockNumber"});case"getGasPrice":return this.fetch("proxy",{action:"eth_gasPrice"});case"getBalance":return this.fetch("account",{action:"balance",address:u.address,tag:u.blockTag});case"getTransactionCount":return this.fetch("proxy",{action:"eth_getTransactionCount",address:u.address,tag:u.blockTag});case"getCode":return this.fetch("proxy",{action:"eth_getCode",address:u.address,tag:u.blockTag});case"getStorageAt":return this.fetch("proxy",{action:"eth_getStorageAt",address:u.address,position:u.position,tag:u.blockTag});case"sendTransaction":return this.fetch("proxy",{action:"eth_sendRawTransaction",hex:u.signedTransaction},!0).catch(ee=>checkError("sendTransaction",ee,u.signedTransaction));case"getBlock":if(u.blockTag)return this.fetch("proxy",{action:"eth_getBlockByNumber",tag:u.blockTag,boolean:u.includeTransactions?"true":"false"});throw new Error("getBlock by blockHash not implemented");case"getTransaction":return this.fetch("proxy",{action:"eth_getTransactionByHash",txhash:u.transactionHash});case"getTransactionReceipt":return this.fetch("proxy",{action:"eth_getTransactionReceipt",txhash:u.transactionHash});case"call":{if(u.blockTag!=="latest")throw new Error("EtherscanProvider does not support blockTag for call");const ee=getTransactionPostData(u.transaction);ee.module="proxy",ee.action="eth_call";try{return yield this.fetch("proxy",ee,!0)}catch(te){return checkError("call",te,u.transaction)}}case"estimateGas":{const ee=getTransactionPostData(u.transaction);ee.module="proxy",ee.action="eth_estimateGas";try{return yield this.fetch("proxy",ee,!0)}catch(te){return checkError("estimateGas",te,u.transaction)}}case"getLogs":{const ee={action:"getLogs"};if(u.filter.fromBlock&&(ee.fromBlock=checkLogTag(u.filter.fromBlock)),u.filter.toBlock&&(ee.toBlock=checkLogTag(u.filter.toBlock)),u.filter.address&&(ee.address=u.filter.address),u.filter.topics&&u.filter.topics.length>0&&(u.filter.topics.length>1&&logger$9.throwError("unsupported topic count",Logger.errors.UNSUPPORTED_OPERATION,{topics:u.filter.topics}),u.filter.topics.length===1)){const ne=u.filter.topics[0];(typeof ne!="string"||ne.length!==66)&&logger$9.throwError("unsupported topic format",Logger.errors.UNSUPPORTED_OPERATION,{topic0:ne}),ee.topic0=ne}const te=yield this.fetch("logs",ee);let ae={};for(let ne=0;ne<te.length;ne++){const oe=te[ne];if(oe.blockHash==null){if(ae[oe.blockNumber]==null){const ie=yield this.getBlock(oe.blockNumber);ie&&(ae[oe.blockNumber]=ie.hash)}oe.blockHash=ae[oe.blockNumber]}}return te}case"getEtherPrice":return this.network.name!=="homestead"?0:parseFloat((yield this.fetch("stats",{action:"ethprice"})).ethusd)}return c.perform.call(this,t,u)})}getHistory(t,u,c){return __awaiter$1(this,void 0,void 0,function*(){const ee={action:"txlist",address:yield this.resolveName(t),startblock:u??0,endblock:c??99999999,sort:"asc"};return(yield this.fetch("account",ee)).map(ae=>{["contractAddress","to"].forEach(function(oe){ae[oe]==""&&delete ae[oe]}),ae.creates==null&&ae.contractAddress!=null&&(ae.creates=ae.contractAddress);const ne=this.formatter.transactionResponse(ae);return ae.timeStamp&&(ne.timestamp=parseInt(ae.timeStamp)),ne})})}isCommunityResource(){return this.apiKey==null}}var __awaiter=function(n,t,u,c){function ee(te){return te instanceof u?te:new u(function(ae){ae(te)})}return new(u||(u=Promise))(function(te,ae){function ne(se){try{ie(c.next(se))}catch(ue){ae(ue)}}function oe(se){try{ie(c.throw(se))}catch(ue){ae(ue)}}function ie(se){se.done?te(se.value):ee(se.value).then(ne,oe)}ie((c=c.apply(n,t||[])).next())})};const logger$8=new Logger(version$9);function now(){return new Date().getTime()}function checkNetworks(n){let t=null;for(let u=0;u<n.length;u++){const c=n[u];if(c==null)return null;t?t.name===c.name&&t.chainId===c.chainId&&(t.ensAddress===c.ensAddress||t.ensAddress==null&&c.ensAddress==null)||logger$8.throwArgumentError("provider mismatch","networks",n):t=c}return t}function median(n,t){n=n.slice().sort();const u=Math.floor(n.length/2);if(n.length%2)return n[u];const c=n[u-1],ee=n[u];return t!=null&&Math.abs(c-ee)>t?null:(c+ee)/2}function serialize(n){if(n===null)return"null";if(typeof n=="number"||typeof n=="boolean")return JSON.stringify(n);if(typeof n=="string")return n;if(BigNumber.isBigNumber(n))return n.toString();if(Array.isArray(n))return JSON.stringify(n.map(t=>serialize(t)));if(typeof n=="object"){const t=Object.keys(n);return t.sort(),"{"+t.map(u=>{let c=n[u];return typeof c=="function"?c="[function]":c=serialize(c),JSON.stringify(u)+":"+c}).join(",")+"}"}throw new Error("unknown value type: "+typeof n)}let nextRid=1;function stall(n){let t=null,u=null,c=new Promise(ae=>{t=function(){u&&(clearTimeout(u),u=null),ae()},u=setTimeout(t,n)});const ee=ae=>(c=c.then(ae),c);function te(){return c}return{cancel:t,getPromise:te,wait:ee}}const ForwardErrors=[Logger.errors.CALL_EXCEPTION,Logger.errors.INSUFFICIENT_FUNDS,Logger.errors.NONCE_EXPIRED,Logger.errors.REPLACEMENT_UNDERPRICED,Logger.errors.UNPREDICTABLE_GAS_LIMIT],ForwardProperties=["address","args","errorArgs","errorSignature","method","transaction"];function exposeDebugConfig(n,t){const u={weight:n.weight};return Object.defineProperty(u,"provider",{get:()=>n.provider}),n.start&&(u.start=n.start),t&&(u.duration=t-n.start),n.done&&(n.error?u.error=n.error:u.result=n.result||null),u}function normalizedTally(n,t){return function(u){const c={};u.forEach(te=>{const ae=n(te.result);c[ae]||(c[ae]={count:0,result:te.result}),c[ae].count++});const ee=Object.keys(c);for(let te=0;te<ee.length;te++){const ae=c[ee[te]];if(ae.count>=t)return ae.result}}}function getProcessFunc(n,t,u){let c=serialize;switch(t){case"getBlockNumber":return function(ee){const te=ee.map(ne=>ne.result);let ae=median(ee.map(ne=>ne.result),2);if(ae!=null)return ae=Math.ceil(ae),te.indexOf(ae+1)>=0&&ae++,ae>=n._highestBlockNumber&&(n._highestBlockNumber=ae),n._highestBlockNumber};case"getGasPrice":return function(ee){const te=ee.map(ae=>ae.result);return te.sort(),te[Math.floor(te.length/2)]};case"getEtherPrice":return function(ee){return median(ee.map(te=>te.result))};case"getBalance":case"getTransactionCount":case"getCode":case"getStorageAt":case"call":case"estimateGas":case"getLogs":break;case"getTransaction":case"getTransactionReceipt":c=function(ee){return ee==null?null:(ee=shallowCopy(ee),ee.confirmations=-1,serialize(ee))};break;case"getBlock":u.includeTransactions?c=function(ee){return ee==null?null:(ee=shallowCopy(ee),ee.transactions=ee.transactions.map(te=>(te=shallowCopy(te),te.confirmations=-1,te)),serialize(ee))}:c=function(ee){return ee==null?null:serialize(ee)};break;default:throw new Error("unknown method: "+t)}return normalizedTally(c,n.quorum)}function waitForSync(n,t){return __awaiter(this,void 0,void 0,function*(){const u=n.provider;return u.blockNumber!=null&&u.blockNumber>=t||t===-1?u:poll(()=>new Promise((c,ee)=>{setTimeout(function(){return u.blockNumber>=t?c(u):n.cancelled?c(null):c(void 0)},0)}),{oncePoll:u})})}function getRunner(n,t,u,c){return __awaiter(this,void 0,void 0,function*(){let ee=n.provider;switch(u){case"getBlockNumber":case"getGasPrice":return ee[u]();case"getEtherPrice":if(ee.getEtherPrice)return ee.getEtherPrice();break;case"getBalance":case"getTransactionCount":case"getCode":return c.blockTag&&isHexString(c.blockTag)&&(ee=yield waitForSync(n,t)),ee[u](c.address,c.blockTag||"latest");case"getStorageAt":return c.blockTag&&isHexString(c.blockTag)&&(ee=yield waitForSync(n,t)),ee.getStorageAt(c.address,c.position,c.blockTag||"latest");case"getBlock":return c.blockTag&&isHexString(c.blockTag)&&(ee=yield waitForSync(n,t)),ee[c.includeTransactions?"getBlockWithTransactions":"getBlock"](c.blockTag||c.blockHash);case"call":case"estimateGas":return c.blockTag&&isHexString(c.blockTag)&&(ee=yield waitForSync(n,t)),u==="call"&&c.blockTag?ee[u](c.transaction,c.blockTag):ee[u](c.transaction);case"getTransaction":case"getTransactionReceipt":return ee[u](c.transactionHash);case"getLogs":{let te=c.filter;return(te.fromBlock&&isHexString(te.fromBlock)||te.toBlock&&isHexString(te.toBlock))&&(ee=yield waitForSync(n,t)),ee.getLogs(te)}}return logger$8.throwError("unknown method error",Logger.errors.UNKNOWN_ERROR,{method:u,params:c})})}class FallbackProvider extends BaseProvider{constructor(t,u){t.length===0&&logger$8.throwArgumentError("missing providers","providers",t);const c=t.map((ae,ne)=>{if(Provider.isProvider(ae)){const se=isCommunityResource(ae)?2e3:750;return Object.freeze({provider:ae,weight:1,stallTimeout:se,priority:1})}const oe=shallowCopy(ae);oe.priority==null&&(oe.priority=1),oe.stallTimeout==null&&(oe.stallTimeout=isCommunityResource(ae)?2e3:750),oe.weight==null&&(oe.weight=1);const ie=oe.weight;return(ie%1||ie>512||ie<1)&&logger$8.throwArgumentError("invalid weight; must be integer in [1, 512]",`providers[${ne}].weight`,ie),Object.freeze(oe)}),ee=c.reduce((ae,ne)=>ae+ne.weight,0);u==null?u=ee/2:u>ee&&logger$8.throwArgumentError("quorum will always fail; larger than total weight","quorum",u);let te=checkNetworks(c.map(ae=>ae.provider.network));te==null&&(te=new Promise((ae,ne)=>{setTimeout(()=>{this.detectNetwork().then(ae,ne)},0)})),super(te),defineReadOnly(this,"providerConfigs",Object.freeze(c)),defineReadOnly(this,"quorum",u),this._highestBlockNumber=-1}detectNetwork(){return __awaiter(this,void 0,void 0,function*(){const t=yield Promise.all(this.providerConfigs.map(u=>u.provider.getNetwork()));return checkNetworks(t)})}perform(t,u){return __awaiter(this,void 0,void 0,function*(){if(t==="sendTransaction"){const oe=yield Promise.all(this.providerConfigs.map(ie=>ie.provider.sendTransaction(u.signedTransaction).then(se=>se.hash,se=>se)));for(let ie=0;ie<oe.length;ie++){const se=oe[ie];if(typeof se=="string")return se}throw oe[0]}this._highestBlockNumber===-1&&t!=="getBlockNumber"&&(yield this.getBlockNumber());const c=getProcessFunc(this,t,u),ee=shuffled(this.providerConfigs.map(shallowCopy));ee.sort((oe,ie)=>oe.priority-ie.priority);const te=this._highestBlockNumber;let ae=0,ne=!0;for(;;){const oe=now();let ie=ee.filter(ce=>ce.runner&&oe-ce.start<ce.stallTimeout).reduce((ce,de)=>ce+de.weight,0);for(;ie<this.quorum&&ae<ee.length;){const ce=ee[ae++],de=nextRid++;ce.start=now(),ce.staller=stall(ce.stallTimeout),ce.staller.wait(()=>{ce.staller=null}),ce.runner=getRunner(ce,te,t,u).then(fe=>{ce.done=!0,ce.result=fe,this.listenerCount("debug")&&this.emit("debug",{action:"request",rid:de,backend:exposeDebugConfig(ce,now()),request:{method:t,params:deepCopy(u)},provider:this})},fe=>{ce.done=!0,ce.error=fe,this.listenerCount("debug")&&this.emit("debug",{action:"request",rid:de,backend:exposeDebugConfig(ce,now()),request:{method:t,params:deepCopy(u)},provider:this})}),this.listenerCount("debug")&&this.emit("debug",{action:"request",rid:de,backend:exposeDebugConfig(ce,null),request:{method:t,params:deepCopy(u)},provider:this}),ie+=ce.weight}const se=[];ee.forEach(ce=>{ce.done||!ce.runner||(se.push(ce.runner),ce.staller&&se.push(ce.staller.getPromise()))}),se.length&&(yield Promise.race(se));const ue=ee.filter(ce=>ce.done&&ce.error==null);if(ue.length>=this.quorum){const ce=c(ue);if(ce!==void 0)return ee.forEach(de=>{de.staller&&de.staller.cancel(),de.cancelled=!0}),ce;ne||(yield stall(100).getPromise()),ne=!1}const le=ee.reduce((ce,de)=>{if(!de.done||de.error==null)return ce;const fe=de.error.code;return ForwardErrors.indexOf(fe)>=0&&(ce[fe]||(ce[fe]={error:de.error,weight:0}),ce[fe].weight+=de.weight),ce},{});if(Object.keys(le).forEach(ce=>{const de=le[ce];if(de.weight<this.quorum)return;ee.forEach(me=>{me.staller&&me.staller.cancel(),me.cancelled=!0});const fe=de.error,pe={};ForwardProperties.forEach(me=>{fe[me]!=null&&(pe[me]=fe[me])}),logger$8.throwError(fe.reason||fe.message,ce,pe)}),ee.filter(ce=>!ce.done).length===0)break}return ee.forEach(oe=>{oe.staller&&oe.staller.cancel(),oe.cancelled=!0}),logger$8.throwError("failed to meet quorum",Logger.errors.SERVER_ERROR,{method:t,params:u,results:ee.map(oe=>exposeDebugConfig(oe)),provider:this})})}}const IpcProvider=null,logger$7=new Logger(version$9),defaultProjectId="84842078b09946638c03157f83405213";class InfuraWebSocketProvider extends WebSocketProvider{constructor(t,u){const c=new InfuraProvider(t,u),ee=c.connection;ee.password&&logger$7.throwError("INFURA WebSocket project secrets unsupported",Logger.errors.UNSUPPORTED_OPERATION,{operation:"InfuraProvider.getWebSocketProvider()"});const te=ee.url.replace(/^http/i,"ws").replace("/v3/","/ws/v3/");super(te,t),defineReadOnly(this,"apiKey",c.projectId),defineReadOnly(this,"projectId",c.projectId),defineReadOnly(this,"projectSecret",c.projectSecret)}isCommunityResource(){return this.projectId===defaultProjectId}}class InfuraProvider extends UrlJsonRpcProvider{static getWebSocketProvider(t,u){return new InfuraWebSocketProvider(t,u)}static getApiKey(t){const u={apiKey:defaultProjectId,projectId:defaultProjectId,projectSecret:null};return t==null||(typeof t=="string"?u.projectId=t:t.projectSecret!=null?(logger$7.assertArgument(typeof t.projectId=="string","projectSecret requires a projectId","projectId",t.projectId),logger$7.assertArgument(typeof t.projectSecret=="string","invalid projectSecret","projectSecret","[REDACTED]"),u.projectId=t.projectId,u.projectSecret=t.projectSecret):t.projectId&&(u.projectId=t.projectId),u.apiKey=u.projectId),u}static getUrl(t,u){let c=null;switch(t?t.name:"unknown"){case"homestead":c="mainnet.infura.io";break;case"goerli":c="goerli.infura.io";break;case"sepolia":c="sepolia.infura.io";break;case"matic":c="polygon-mainnet.infura.io";break;case"maticmum":c="polygon-mumbai.infura.io";break;case"optimism":c="optimism-mainnet.infura.io";break;case"optimism-goerli":c="optimism-goerli.infura.io";break;case"arbitrum":c="arbitrum-mainnet.infura.io";break;case"arbitrum-goerli":c="arbitrum-goerli.infura.io";break;default:logger$7.throwError("unsupported network",Logger.errors.INVALID_ARGUMENT,{argument:"network",value:t})}const ee={allowGzip:!0,url:"https://"+c+"/v3/"+u.projectId,throttleCallback:(te,ae)=>(u.projectId===defaultProjectId&&showThrottleMessage(),Promise.resolve(!0))};return u.projectSecret!=null&&(ee.user="",ee.password=u.projectSecret),ee}isCommunityResource(){return this.projectId===defaultProjectId}}class JsonRpcBatchProvider extends JsonRpcProvider{send(t,u){const c={method:t,params:u,id:this._nextId++,jsonrpc:"2.0"};this._pendingBatch==null&&(this._pendingBatch=[]);const ee={request:c,resolve:null,reject:null},te=new Promise((ae,ne)=>{ee.resolve=ae,ee.reject=ne});return this._pendingBatch.push(ee),this._pendingBatchAggregator||(this._pendingBatchAggregator=setTimeout(()=>{const ae=this._pendingBatch;this._pendingBatch=null,this._pendingBatchAggregator=null;const ne=ae.map(oe=>oe.request);return this.emit("debug",{action:"requestBatch",request:deepCopy(ne),provider:this}),fetchJson(this.connection,JSON.stringify(ne)).then(oe=>{this.emit("debug",{action:"response",request:ne,response:oe,provider:this}),ae.forEach((ie,se)=>{const ue=oe[se];if(ue.error){const le=new Error(ue.error.message);le.code=ue.error.code,le.data=ue.error.data,ie.reject(le)}else ie.resolve(ue.result)})},oe=>{this.emit("debug",{action:"response",error:oe,request:ne,provider:this}),ae.forEach(ie=>{ie.reject(oe)})})},10)),te}}const logger$6=new Logger(version$9),defaultApiKey="ETHERS_JS_SHARED";class NodesmithProvider extends UrlJsonRpcProvider{static getApiKey(t){return t&&typeof t!="string"&&logger$6.throwArgumentError("invalid apiKey","apiKey",t),t||defaultApiKey}static getUrl(t,u){logger$6.warn("NodeSmith will be discontinued on 2019-12-20; please migrate to another platform.");let c=null;switch(t.name){case"homestead":c="https://ethereum.api.nodesmith.io/v1/mainnet/jsonrpc";break;case"ropsten":c="https://ethereum.api.nodesmith.io/v1/ropsten/jsonrpc";break;case"rinkeby":c="https://ethereum.api.nodesmith.io/v1/rinkeby/jsonrpc";break;case"goerli":c="https://ethereum.api.nodesmith.io/v1/goerli/jsonrpc";break;case"kovan":c="https://ethereum.api.nodesmith.io/v1/kovan/jsonrpc";break;default:logger$6.throwArgumentError("unsupported network","network",arguments[0])}return c+"?apiKey="+u}}const logger$5=new Logger(version$9),defaultApplicationId="62e1ad51b37b8e00394bda3b";class PocketProvider extends UrlJsonRpcProvider{static getApiKey(t){const u={applicationId:null,loadBalancer:!0,applicationSecretKey:null};return t==null?u.applicationId=defaultApplicationId:typeof t=="string"?u.applicationId=t:t.applicationSecretKey!=null?(u.applicationId=t.applicationId,u.applicationSecretKey=t.applicationSecretKey):t.applicationId?u.applicationId=t.applicationId:logger$5.throwArgumentError("unsupported PocketProvider apiKey","apiKey",t),u}static getUrl(t,u){let c=null;switch(t?t.name:"unknown"){case"goerli":c="eth-goerli.gateway.pokt.network";break;case"homestead":c="eth-mainnet.gateway.pokt.network";break;case"kovan":c="poa-kovan.gateway.pokt.network";break;case"matic":c="poly-mainnet.gateway.pokt.network";break;case"maticmum":c="polygon-mumbai-rpc.gateway.pokt.network";break;case"rinkeby":c="eth-rinkeby.gateway.pokt.network";break;case"ropsten":c="eth-ropsten.gateway.pokt.network";break;default:logger$5.throwError("unsupported network",Logger.errors.INVALID_ARGUMENT,{argument:"network",value:t})}const ee=`https://${c}/v1/lb/${u.applicationId}`,te={headers:{},url:ee};return u.applicationSecretKey!=null&&(te.user="",te.password=u.applicationSecretKey),te}isCommunityResource(){return this.applicationId===defaultApplicationId}}const logger$4=new Logger(version$9);let _nextId=1;function buildWeb3LegacyFetcher(n,t){const u="Web3LegacyFetcher";return function(c,ee){const te={method:c,params:ee,id:_nextId++,jsonrpc:"2.0"};return new Promise((ae,ne)=>{this.emit("debug",{action:"request",fetcher:u,request:deepCopy(te),provider:this}),t(te,(oe,ie)=>{if(oe)return this.emit("debug",{action:"response",fetcher:u,error:oe,request:te,provider:this}),ne(oe);if(this.emit("debug",{action:"response",fetcher:u,request:te,response:ie,provider:this}),ie.error){const se=new Error(ie.error.message);return se.code=ie.error.code,se.data=ie.error.data,ne(se)}ae(ie.result)})})}}function buildEip1193Fetcher(n){return function(t,u){u==null&&(u=[]);const c={method:t,params:u};return this.emit("debug",{action:"request",fetcher:"Eip1193Fetcher",request:deepCopy(c),provider:this}),n.request(c).then(ee=>(this.emit("debug",{action:"response",fetcher:"Eip1193Fetcher",request:c,response:ee,provider:this}),ee),ee=>{throw this.emit("debug",{action:"response",fetcher:"Eip1193Fetcher",request:c,error:ee,provider:this}),ee})}}class Web3Provider extends JsonRpcProvider{constructor(t,u){t==null&&logger$4.throwArgumentError("missing provider","provider",t);let c=null,ee=null,te=null;typeof t=="function"?(c="unknown:",ee=t):(c=t.host||t.path||"",!c&&t.isMetaMask&&(c="metamask"),te=t,t.request?(c===""&&(c="eip-1193:"),ee=buildEip1193Fetcher(t)):t.sendAsync?ee=buildWeb3LegacyFetcher(t,t.sendAsync.bind(t)):t.send?ee=buildWeb3LegacyFetcher(t,t.send.bind(t)):logger$4.throwArgumentError("unsupported provider","provider",t),c||(c="unknown:")),super(c,u),defineReadOnly(this,"jsonRpcFetchFunc",ee),defineReadOnly(this,"provider",te)}send(t,u){return this.jsonRpcFetchFunc(t,u)}}const logger$3=new Logger(version$9);function getDefaultProvider(n,t){if(n==null&&(n="homestead"),typeof n=="string"){const c=n.match(/^(ws|http)s?:/i);if(c)switch(c[1].toLowerCase()){case"http":case"https":return new JsonRpcProvider(n);case"ws":case"wss":return new WebSocketProvider(n);default:logger$3.throwArgumentError("unsupported URL scheme","network",n)}}const u=getNetwork(n);return(!u||!u._defaultProvider)&&logger$3.throwError("unsupported getDefaultProvider network",Logger.errors.NETWORK_ERROR,{operation:"getDefaultProvider",network:n}),u._defaultProvider({FallbackProvider,AlchemyProvider,AnkrProvider,CloudflareProvider,EtherscanProvider,InfuraProvider,JsonRpcProvider,NodesmithProvider,PocketProvider,Web3Provider,IpcProvider},t)}const index=Object.freeze(Object.defineProperty({__proto__:null,AlchemyProvider,AlchemyWebSocketProvider,AnkrProvider,BaseProvider,CloudflareProvider,EtherscanProvider,FallbackProvider,Formatter,InfuraProvider,InfuraWebSocketProvider,IpcProvider,JsonRpcBatchProvider,JsonRpcProvider,JsonRpcSigner,NodesmithProvider,PocketProvider,Provider,Resolver,StaticJsonRpcProvider,UrlJsonRpcProvider,Web3Provider,WebSocketProvider,getDefaultProvider,getNetwork,isCommunityResourcable,isCommunityResource,showThrottleMessage},Symbol.toStringTag,{value:"Module"})),version$8="solidity/5.7.0",regexBytes=new RegExp("^bytes([0-9]+)$"),regexNumber=new RegExp("^(u?int)([0-9]*)$"),regexArray=new RegExp("^(.*)\\[([0-9]*)\\]$"),Zeros="0000000000000000000000000000000000000000000000000000000000000000",logger$2=new Logger(version$8);function _pack(n,t,u){switch(n){case"address":return u?zeroPad(t,32):arrayify(t);case"string":return toUtf8Bytes(t);case"bytes":return arrayify(t);case"bool":return t=t?"0x01":"0x00",u?zeroPad(t,32):arrayify(t)}let c=n.match(regexNumber);if(c){let ee=parseInt(c[2]||"256");return(c[2]&&String(ee)!==c[2]||ee%8!==0||ee===0||ee>256)&&logger$2.throwArgumentError("invalid number type","type",n),u&&(ee=256),t=BigNumber.from(t).toTwos(ee),zeroPad(t,ee/8)}if(c=n.match(regexBytes),c){const ee=parseInt(c[1]);return(String(ee)!==c[1]||ee===0||ee>32)&&logger$2.throwArgumentError("invalid bytes type","type",n),arrayify(t).byteLength!==ee&&logger$2.throwArgumentError(`invalid value for ${n}`,"value",t),u?arrayify((t+Zeros).substring(0,66)):t}if(c=n.match(regexArray),c&&Array.isArray(t)){const ee=c[1];parseInt(c[2]||String(t.length))!=t.length&&logger$2.throwArgumentError(`invalid array length for ${n}`,"value",t);const ae=[];return t.forEach(function(ne){ae.push(_pack(ee,ne,!0))}),concat$4(ae)}return logger$2.throwArgumentError("invalid type","type",n)}function pack(n,t){n.length!=t.length&&logger$2.throwArgumentError("wrong number of values; expected ${ types.length }","values",t);const u=[];return n.forEach(function(c,ee){u.push(_pack(c,t[ee]))}),hexlify(concat$4(u))}function keccak256(n,t){return keccak256$1(pack(n,t))}function sha256$1(n,t){return sha256$2(pack(n,t))}const version$7="units/5.7.0",logger$1=new Logger(version$7),names=["wei","kwei","mwei","gwei","szabo","finney","ether"];function commify(n){const t=String(n).split(".");(t.length>2||!t[0].match(/^-?[0-9]*$/)||t[1]&&!t[1].match(/^[0-9]*$/)||n==="."||n==="-.")&&logger$1.throwArgumentError("invalid value","value",n);let u=t[0],c="";for(u.substring(0,1)==="-"&&(c="-",u=u.substring(1));u.substring(0,1)==="0";)u=u.substring(1);u===""&&(u="0");let ee="";for(t.length===2&&(ee="."+(t[1]||"0"));ee.length>2&&ee[ee.length-1]==="0";)ee=ee.substring(0,ee.length-1);const te=[];for(;u.length;)if(u.length<=3){te.unshift(u);break}else{const ae=u.length-3;te.unshift(u.substring(ae)),u=u.substring(0,ae)}return c+te.join(",")+ee}function formatUnits(n,t){if(typeof t=="string"){const u=names.indexOf(t);u!==-1&&(t=3*u)}return formatFixed(n,t??18)}function parseUnits(n,t){if(typeof n!="string"&&logger$1.throwArgumentError("value must be a string","value",n),typeof t=="string"){const u=names.indexOf(t);u!==-1&&(t=3*u)}return parseFixed(n,t??18)}function formatEther(n){return formatUnits(n,18)}function parseEther(n){return parseUnits(n,18)}const utils$5=Object.freeze(Object.defineProperty({__proto__:null,AbiCoder,ConstructorFragment,ErrorFragment,EventFragment,FormatTypes,Fragment:Fragment$1,FunctionFragment,HDNode,Indexed,Interface,LogDescription,Logger,ParamType,RLP:lib_esm$1,SigningKey,get SupportedAlgorithm(){return SupportedAlgorithm},TransactionDescription,get TransactionTypes(){return TransactionTypes},get UnicodeNormalizationForm(){return UnicodeNormalizationForm},Utf8ErrorFuncs,get Utf8ErrorReason(){return Utf8ErrorReason},_TypedDataEncoder:TypedDataEncoder,_fetchData,_toEscapedUtf8String,accessListify,arrayify,base58:Base58,base64:index$2,checkProperties,checkResultErrors,commify,computeAddress,computeHmac,computePublicKey,concat:concat$4,deepCopy,defaultAbiCoder,defaultPath,defineReadOnly,dnsEncode,entropyToMnemonic,fetchJson,formatBytes32String,formatEther,formatUnits,getAccountPath,getAddress,getContractAddress,getCreate2Address,getIcapAddress,getJsonWalletAddress,getStatic,hashMessage,hexConcat,hexDataLength,hexDataSlice,hexStripZeros,hexValue,hexZeroPad,hexlify,id:id$1,isAddress,isBytes,isBytesLike,isHexString,isValidMnemonic,isValidName,joinSignature,keccak256:keccak256$1,mnemonicToEntropy,mnemonicToSeed,namehash:namehash$2,nameprep,parseBytes32String,parseEther,parseTransaction:parse$3,parseUnits,poll,randomBytes,recoverAddress,recoverPublicKey,resolveProperties,ripemd160:ripemd160$2,serializeTransaction:serialize$1,sha256:sha256$2,sha512:sha512$3,shallowCopy,shuffled,solidityKeccak256:keccak256,solidityPack:pack,soliditySha256:sha256$1,splitSignature,stripZeros,toUtf8Bytes,toUtf8CodePoints,toUtf8String,verifyMessage,verifyTypedData,zeroPad},Symbol.toStringTag,{value:"Module"})),version$6="ethers/5.7.2",logger=new Logger(version$6),ethers=Object.freeze(Object.defineProperty({__proto__:null,BaseContract,BigNumber,Contract,ContractFactory,FixedNumber,Signer:Signer$1,VoidSigner,Wallet,Wordlist,constants:index$3,get errors(){return ErrorCode$1},getDefaultProvider,logger,providers:index,utils:utils$5,version:version$6,wordlists},Symbol.toStringTag,{value:"Module"}));try{const n=window;n._ethers==null&&(n._ethers=ethers)}catch{}const lib_esm=Object.freeze(Object.defineProperty({__proto__:null,BaseContract,BigNumber,Contract,ContractFactory,FixedNumber,Signer:Signer$1,VoidSigner,Wallet,Wordlist,constants:index$3,get errors(){return ErrorCode$1},ethers,getDefaultProvider,logger,providers:index,utils:utils$5,version:version$6,wordlists},Symbol.toStringTag,{value:"Module"})),evmCoinTypeToNameMap=Object.freeze({"2147483658":["op","Optimism"],"2147483673":["cro","Cronos"],"2147483704":["bsc","BNB Smart Chain"],"2147483708":["go","GoChain"],"2147483709":["etc","Ethereum Classic"],"2147483736":["tomo","TomoChain"],"2147483747":["poa","POA"],"2147483748":["gno","Gnosis"],"2147483756":["tt","ThunderCore"],"2147483785":["matic","Polygon"],"2147483817":["manta","Manta Pacific"],"2147483894":["ewt","Energy Web"],"2147483898":["ftm","Fantom Opera"],"2147483936":["boba","Boba"],"2147483972":["zksync","zkSync"],"2147484009":["theta","Theta"],"2147484468":["clo","Callisto"],"2147484736":["metis","Metis"],"2147488648":["mantle","Mantle"],"2147492101":["base","Base"],"2147523445":["nrg","Energi"],"2147525809":["arb1","Arbitrum One"],"2147525868":["celo","Celo"],"2147526762":["avaxc","Avalanche C-Chain"],"2147542792":["linea","Linea"],"2148018000":["scr","Scroll"],"2155261425":["zora","Zora"]}),nonEvmCoinTypeToNameMap=Object.freeze({0:["btc","Bitcoin"],2:["ltc","Litecoin"],3:["doge","Dogecoin"],4:["rdd","Reddcoin"],5:["dash","Dash"],6:["ppc","Peercoin"],7:["nmc","Namecoin"],14:["via","Viacoin"],20:["dgb","DigiByte"],22:["mona","Monacoin"],42:["dcr","Decred"],43:["xem","NEM"],55:["aib","AIB"],57:["sys","Syscoin"],60:["eth","Ethereum"],61:["etcLegacy","[LEGACY] Ethereum Classic"],74:["icx","ICON"],77:["xvg","Verge"],105:["strat","Stratis"],111:["ark","ARK"],118:["atom","Atom"],121:["zen","Zencash"],128:["xmr","Monero"],133:["zec","Zcash"],134:["lsk","Lisk"],135:["steem","Steem"],136:["firo","Firo"],137:["rbtc","RSK"],141:["kmd","Komodo"],144:["xrp","Ripple"],145:["bch","Bitcoin Cash"],148:["xlm","Stellar Lumens"],153:["btm","Bytom"],156:["btg","Bitcoin Gold"],165:["nano","Nano"],175:["rvn","Ravencoin"],178:["poaLegacy","[LEGACY] POA"],192:["lcc","LitecoinCash"],194:["eos","EOS"],195:["trx","Tron"],204:["bcn","Bytecoin"],235:["fio","FIO"],236:["bsv","BitcoinSV"],242:["nim","Nimiq"],246:["ewtLegacy","[LEGACY] Energy Web"],283:["algo","Algorand"],291:["iost","IOST"],301:["divi","Divi Project"],304:["iotx","IoTeX"],308:["bts","Bitshares"],309:["ckb","Nervos CKB"],313:["zil","Zilliqa"],326:["mrx","Metrix Coin"],330:["luna","Terra"],354:["dot","Polkadot"],360:["vsys","V Systems"],367:["abbc","ABBC"],397:["near","NEAR Protocol"],415:["etn","Electroneum"],425:["aion","Aion"],434:["ksm","Kusama"],457:["ae","ternity"],459:["kava","Kava"],461:["fil","Filecoin"],472:["ar","Arweave"],489:["cca","Counos"],500:["thetaLegacy","[LEGACY] Theta"],501:["sol","Solana"],508:["egld","MultiversX"],535:["xhv","Haven Protocol"],539:["flow","Flow"],566:["iris","Irisnet"],568:["lrg","Large Coin"],569:["sero","Super Zero Protocol"],570:["bdx","Beldex"],571:["ccxx","Counos X"],573:["srm","Serum"],574:["vlxLegacy","[LEGACY] Velas"],576:["bps","BitcoinPoS"],589:["tfuel","Theta Fuel"],592:["grin","Grin"],700:["gnoLegacy","[LEGACY] Gnosis"],714:["bnb","BNB"],818:["vet","VeChain"],820:["cloLegacy","[LEGACY] Callisto"],825:["hive","Hive"],888:["neo","NEO"],889:["tomoLegacy","[LEGACY] TomoChain"],904:["hnt","Helium"],931:["rune","THORChain"],999:["bcd","Bitcoin Diamond"],1001:["ttLegacy","[LEGACY] ThunderCore"],1007:["ftmLegacy","[LEGACY] Fantom"],1023:["one","HARMONY-ONE"],1024:["ont","Ontology"],1237:["nostr","Nostr"],1729:["xtz","Tezos"],1815:["ada","Cardano"],1991:["sc","Sia"],2301:["qtum","QTUM"],2303:["gxc","GXChain"],2305:["ela","Elastos"],2718:["nas","Nebulas"],3030:["hbar","Hedera HBAR"],4218:["iota","IOTA"],5353:["hns","Handshake"],5757:["stx","Stacks"],6060:["goLegacy","[LEGACY] GoChain"],8444:["xch","Chia"],8964:["nuls","NULS"],9e3:["avax","Avalanche"],9004:["strk","StarkNet"],9797:["nrgLegacy","[LEGACY] Energi"],16754:["ardr","Ardor"],19167:["flux","Flux"],52752:["celoLegacy","[LEGACY] Celo"],99999:["wicc","Waykichain"],5655640:["vlx","Velas"],5718350:["wan","Wanchain"],5741564:["waves","Waves"]});Object.freeze({...nonEvmCoinTypeToNameMap,...evmCoinTypeToNameMap});const evmCoinNameToTypeMap=Object.freeze(Object.fromEntries(Object.entries(evmCoinTypeToNameMap).map(([n,[t]])=>[t,parseInt(n)]))),nonEvmCoinNameToTypeMap=Object.freeze(Object.fromEntries(Object.entries(nonEvmCoinTypeToNameMap).map(([n,[t]])=>[t,parseInt(n)]))),coinNameToTypeMap=Object.freeze({...evmCoinNameToTypeMap,...nonEvmCoinNameToTypeMap}),getTLD=n=>{const t=n.split(".");return t.length<2?"":t[t.length-1]};class ENSResolver{constructor(t){this.options=t,this.name="ens"}async init(){this.ENSProvider=new JsonRpcProvider({url:this.options.node,headers:{"user-agent":"enkrypt/name-resolver"}})}async resolveReverseName(t){const u=await this.ENSProvider.lookupAddress(t);return u||null}async resolveAddress(t,u="ETH"){const c=await this.ENSProvider.getResolver(t);return c?c.getAddress(coinNameToTypeMap[u.toLowerCase()]).then(ee=>ee||null):null}isSupportedName(t){return getTLD(t).length>2}}var build$1={},Resolution={},bn$3={exports:{}},bn$2=bn$3.exports,hasRequiredBn$1;function requireBn$1(){return hasRequiredBn$1||(hasRequiredBn$1=1,function(n){(function(t,u){function c(Ae,he){if(!Ae)throw new Error(he||"Assertion failed")}function ee(Ae,he){Ae.super_=he;var ve=function(){};ve.prototype=he.prototype,Ae.prototype=new ve,Ae.prototype.constructor=Ae}function te(Ae,he,ve){if(te.isBN(Ae))return Ae;this.negative=0,this.words=null,this.length=0,this.red=null,Ae!==null&&((he==="le"||he==="be")&&(ve=he,he=10),this._init(Ae||0,he||10,ve||"be"))}typeof t=="object"?t.exports=te:u.BN=te,te.BN=te,te.wordSize=26;var ae;try{typeof window<"u"&&typeof window.Buffer<"u"?ae=window.Buffer:ae=requireDist$5().Buffer}catch{}te.isBN=function(he){return he instanceof te?!0:he!==null&&typeof he=="object"&&he.constructor.wordSize===te.wordSize&&Array.isArray(he.words)},te.max=function(he,ve){return he.cmp(ve)>0?he:ve},te.min=function(he,ve){return he.cmp(ve)<0?he:ve},te.prototype._init=function(he,ve,ye){if(typeof he=="number")return this._initNumber(he,ve,ye);if(typeof he=="object")return this._initArray(he,ve,ye);ve==="hex"&&(ve=16),c(ve===(ve|0)&&ve>=2&&ve<=36),he=he.toString().replace(/\s+/g,"");var be=0;he[0]==="-"&&(be++,this.negative=1),be<he.length&&(ve===16?this._parseHex(he,be,ye):(this._parseBase(he,ve,be),ye==="le"&&this._initArray(this.toArray(),ve,ye)))},te.prototype._initNumber=function(he,ve,ye){he<0&&(this.negative=1,he=-he),he<67108864?(this.words=[he&67108863],this.length=1):he<4503599627370496?(this.words=[he&67108863,he/67108864&67108863],this.length=2):(c(he<9007199254740992),this.words=[he&67108863,he/67108864&67108863,1],this.length=3),ye==="le"&&this._initArray(this.toArray(),ve,ye)},te.prototype._initArray=function(he,ve,ye){if(c(typeof he.length=="number"),he.length<=0)return this.words=[0],this.length=1,this;this.length=Math.ceil(he.length/3),this.words=new Array(this.length);for(var be=0;be<this.length;be++)this.words[be]=0;var _e,Me,Ie=0;if(ye==="be")for(be=he.length-1,_e=0;be>=0;be-=3)Me=he[be]|he[be-1]<<8|he[be-2]<<16,this.words[_e]|=Me<<Ie&67108863,this.words[_e+1]=Me>>>26-Ie&67108863,Ie+=24,Ie>=26&&(Ie-=26,_e++);else if(ye==="le")for(be=0,_e=0;be<he.length;be+=3)Me=he[be]|he[be+1]<<8|he[be+2]<<16,this.words[_e]|=Me<<Ie&67108863,this.words[_e+1]=Me>>>26-Ie&67108863,Ie+=24,Ie>=26&&(Ie-=26,_e++);return this.strip()};function ne(Ae,he){var ve=Ae.charCodeAt(he);return ve>=65&&ve<=70?ve-55:ve>=97&&ve<=102?ve-87:ve-48&15}function oe(Ae,he,ve){var ye=ne(Ae,ve);return ve-1>=he&&(ye|=ne(Ae,ve-1)<<4),ye}te.prototype._parseHex=function(he,ve,ye){this.length=Math.ceil((he.length-ve)/6),this.words=new Array(this.length);for(var be=0;be<this.length;be++)this.words[be]=0;var _e=0,Me=0,Ie;if(ye==="be")for(be=he.length-1;be>=ve;be-=2)Ie=oe(he,ve,be)<<_e,this.words[Me]|=Ie&67108863,_e>=18?(_e-=18,Me+=1,this.words[Me]|=Ie>>>26):_e+=8;else{var Fe=he.length-ve;for(be=Fe%2===0?ve+1:ve;be<he.length;be+=2)Ie=oe(he,ve,be)<<_e,this.words[Me]|=Ie&67108863,_e>=18?(_e-=18,Me+=1,this.words[Me]|=Ie>>>26):_e+=8}this.strip()};function ie(Ae,he,ve,ye){for(var be=0,_e=Math.min(Ae.length,ve),Me=he;Me<_e;Me++){var Ie=Ae.charCodeAt(Me)-48;be*=ye,Ie>=49?be+=Ie-49+10:Ie>=17?be+=Ie-17+10:be+=Ie}return be}te.prototype._parseBase=function(he,ve,ye){this.words=[0],this.length=1;for(var be=0,_e=1;_e<=67108863;_e*=ve)be++;be--,_e=_e/ve|0;for(var Me=he.length-ye,Ie=Me%be,Fe=Math.min(Me,Me-Ie)+ye,Ee=0,ke=ye;ke<Fe;ke+=be)Ee=ie(he,ke,ke+be,ve),this.imuln(_e),this.words[0]+Ee<67108864?this.words[0]+=Ee:this._iaddn(Ee);if(Ie!==0){var Ve=1;for(Ee=ie(he,ke,he.length,ve),ke=0;ke<Ie;ke++)Ve*=ve;this.imuln(Ve),this.words[0]+Ee<67108864?this.words[0]+=Ee:this._iaddn(Ee)}this.strip()},te.prototype.copy=function(he){he.words=new Array(this.length);for(var ve=0;ve<this.length;ve++)he.words[ve]=this.words[ve];he.length=this.length,he.negative=this.negative,he.red=this.red},te.prototype.clone=function(){var he=new te(null);return this.copy(he),he},te.prototype._expand=function(he){for(;this.length<he;)this.words[this.length++]=0;return this},te.prototype.strip=function(){for(;this.length>1&&this.words[this.length-1]===0;)this.length--;return this._normSign()},te.prototype._normSign=function(){return this.length===1&&this.words[0]===0&&(this.negative=0),this},te.prototype.inspect=function(){return(this.red?"<BN-R: ":"<BN: ")+this.toString(16)+">"};var se=["","0","00","000","0000","00000","000000","0000000","00000000","000000000","0000000000","00000000000","000000000000","0000000000000","00000000000000","000000000000000","0000000000000000","00000000000000000","000000000000000000","0000000000000000000","00000000000000000000","000000000000000000000","0000000000000000000000","00000000000000000000000","000000000000000000000000","0000000000000000000000000"],ue=[0,0,25,16,12,11,10,9,8,8,7,7,7,7,6,6,6,6,6,6,6,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5,5],le=[0,0,33554432,43046721,16777216,48828125,60466176,40353607,16777216,43046721,1e7,19487171,35831808,62748517,7529536,11390625,16777216,24137569,34012224,47045881,64e6,4084101,5153632,6436343,7962624,9765625,11881376,14348907,17210368,20511149,243e5,28629151,33554432,39135393,45435424,52521875,60466176];te.prototype.toString=function(he,ve){he=he||10,ve=ve|0||1;var ye;if(he===16||he==="hex"){ye="";for(var be=0,_e=0,Me=0;Me<this.length;Me++){var Ie=this.words[Me],Fe=((Ie<<be|_e)&16777215).toString(16);_e=Ie>>>24-be&16777215,_e!==0||Me!==this.length-1?ye=se[6-Fe.length]+Fe+ye:ye=Fe+ye,be+=2,be>=26&&(be-=26,Me--)}for(_e!==0&&(ye=_e.toString(16)+ye);ye.length%ve!==0;)ye="0"+ye;return this.negative!==0&&(ye="-"+ye),ye}if(he===(he|0)&&he>=2&&he<=36){var Ee=ue[he],ke=le[he];ye="";var Ve=this.clone();for(Ve.negative=0;!Ve.isZero();){var ze=Ve.modn(ke).toString(he);Ve=Ve.idivn(ke),Ve.isZero()?ye=ze+ye:ye=se[Ee-ze.length]+ze+ye}for(this.isZero()&&(ye="0"+ye);ye.length%ve!==0;)ye="0"+ye;return this.negative!==0&&(ye="-"+ye),ye}c(!1,"Base should be between 2 and 36")},te.prototype.toNumber=function(){var he=this.words[0];return this.length===2?he+=this.words[1]*67108864:this.length===3&&this.words[2]===1?he+=4503599627370496+this.words[1]*67108864:this.length>2&&c(!1,"Number can only safely store up to 53 bits"),this.negative!==0?-he:he},te.prototype.toJSON=function(){return this.toString(16)},te.prototype.toBuffer=function(he,ve){return c(typeof ae<"u"),this.toArrayLike(ae,he,ve)},te.prototype.toArray=function(he,ve){return this.toArrayLike(Array,he,ve)},te.prototype.toArrayLike=function(he,ve,ye){var be=this.byteLength(),_e=ye||Math.max(1,be);c(be<=_e,"byte array longer than desired length"),c(_e>0,"Requested array length <= 0"),this.strip();var Me=ve==="le",Ie=new he(_e),Fe,Ee,ke=this.clone();if(Me){for(Ee=0;!ke.isZero();Ee++)Fe=ke.andln(255),ke.iushrn(8),Ie[Ee]=Fe;for(;Ee<_e;Ee++)Ie[Ee]=0}else{for(Ee=0;Ee<_e-be;Ee++)Ie[Ee]=0;for(Ee=0;!ke.isZero();Ee++)Fe=ke.andln(255),ke.iushrn(8),Ie[_e-Ee-1]=Fe}return Ie},Math.clz32?te.prototype._countBits=function(he){return 32-Math.clz32(he)}:te.prototype._countBits=function(he){var ve=he,ye=0;return ve>=4096&&(ye+=13,ve>>>=13),ve>=64&&(ye+=7,ve>>>=7),ve>=8&&(ye+=4,ve>>>=4),ve>=2&&(ye+=2,ve>>>=2),ye+ve},te.prototype._zeroBits=function(he){if(he===0)return 26;var ve=he,ye=0;return ve&8191||(ye+=13,ve>>>=13),ve&127||(ye+=7,ve>>>=7),ve&15||(ye+=4,ve>>>=4),ve&3||(ye+=2,ve>>>=2),ve&1||ye++,ye},te.prototype.bitLength=function(){var he=this.words[this.length-1],ve=this._countBits(he);return(this.length-1)*26+ve};function ce(Ae){for(var he=new Array(Ae.bitLength()),ve=0;ve<he.length;ve++){var ye=ve/26|0,be=ve%26;he[ve]=(Ae.words[ye]&1<<be)>>>be}return he}te.prototype.zeroBits=function(){if(this.isZero())return 0;for(var he=0,ve=0;ve<this.length;ve++){var ye=this._zeroBits(this.words[ve]);if(he+=ye,ye!==26)break}return he},te.prototype.byteLength=function(){return Math.ceil(this.bitLength()/8)},te.prototype.toTwos=function(he){return this.negative!==0?this.abs().inotn(he).iaddn(1):this.clone()},te.prototype.fromTwos=function(he){return this.testn(he-1)?this.notn(he).iaddn(1).ineg():this.clone()},te.prototype.isNeg=function(){return this.negative!==0},te.prototype.neg=function(){return this.clone().ineg()},te.prototype.ineg=function(){return this.isZero()||(this.negative^=1),this},te.prototype.iuor=function(he){for(;this.length<he.length;)this.words[this.length++]=0;for(var ve=0;ve<he.length;ve++)this.words[ve]=this.words[ve]|he.words[ve];return this.strip()},te.prototype.ior=function(he){return c((this.negative|he.negative)===0),this.iuor(he)},te.prototype.or=function(he){return this.length>he.length?this.clone().ior(he):he.clone().ior(this)},te.prototype.uor=function(he){return this.length>he.length?this.clone().iuor(he):he.clone().iuor(this)},te.prototype.iuand=function(he){var ve;this.length>he.length?ve=he:ve=this;for(var ye=0;ye<ve.length;ye++)this.words[ye]=this.words[ye]&he.words[ye];return this.length=ve.length,this.strip()},te.prototype.iand=function(he){return c((this.negative|he.negative)===0),this.iuand(he)},te.prototype.and=function(he){return this.length>he.length?this.clone().iand(he):he.clone().iand(this)},te.prototype.uand=function(he){return this.length>he.length?this.clone().iuand(he):he.clone().iuand(this)},te.prototype.iuxor=function(he){var ve,ye;this.length>he.length?(ve=this,ye=he):(ve=he,ye=this);for(var be=0;be<ye.length;be++)this.words[be]=ve.words[be]^ye.words[be];if(this!==ve)for(;be<ve.length;be++)this.words[be]=ve.words[be];return this.length=ve.length,this.strip()},te.prototype.ixor=function(he){return c((this.negative|he.negative)===0),this.iuxor(he)},te.prototype.xor=function(he){return this.length>he.length?this.clone().ixor(he):he.clone().ixor(this)},te.prototype.uxor=function(he){return this.length>he.length?this.clone().iuxor(he):he.clone().iuxor(this)},te.prototype.inotn=function(he){c(typeof he=="number"&&he>=0);var ve=Math.ceil(he/26)|0,ye=he%26;this._expand(ve),ye>0&&ve--;for(var be=0;be<ve;be++)this.words[be]=~this.words[be]&67108863;return ye>0&&(this.words[be]=~this.words[be]&67108863>>26-ye),this.strip()},te.prototype.notn=function(he){return this.clone().inotn(he)},te.prototype.setn=function(he,ve){c(typeof he=="number"&&he>=0);var ye=he/26|0,be=he%26;return this._expand(ye+1),ve?this.words[ye]=this.words[ye]|1<<be:this.words[ye]=this.words[ye]&~(1<<be),this.strip()},te.prototype.iadd=function(he){var ve;if(this.negative!==0&&he.negative===0)return this.negative=0,ve=this.isub(he),this.negative^=1,this._normSign();if(this.negative===0&&he.negative!==0)return he.negative=0,ve=this.isub(he),he.negative=1,ve._normSign();var ye,be;this.length>he.length?(ye=this,be=he):(ye=he,be=this);for(var _e=0,Me=0;Me<be.length;Me++)ve=(ye.words[Me]|0)+(be.words[Me]|0)+_e,this.words[Me]=ve&67108863,_e=ve>>>26;for(;_e!==0&&Me<ye.length;Me++)ve=(ye.words[Me]|0)+_e,this.words[Me]=ve&67108863,_e=ve>>>26;if(this.length=ye.length,_e!==0)this.words[this.length]=_e,this.length++;else if(ye!==this)for(;Me<ye.length;Me++)this.words[Me]=ye.words[Me];return this},te.prototype.add=function(he){var ve;return he.negative!==0&&this.negative===0?(he.negative=0,ve=this.sub(he),he.negative^=1,ve):he.negative===0&&this.negative!==0?(this.negative=0,ve=he.sub(this),this.negative=1,ve):this.length>he.length?this.clone().iadd(he):he.clone().iadd(this)},te.prototype.isub=function(he){if(he.negative!==0){he.negative=0;var ve=this.iadd(he);return he.negative=1,ve._normSign()}else if(this.negative!==0)return this.negative=0,this.iadd(he),this.negative=1,this._normSign();var ye=this.cmp(he);if(ye===0)return this.negative=0,this.length=1,this.words[0]=0,this;var be,_e;ye>0?(be=this,_e=he):(be=he,_e=this);for(var Me=0,Ie=0;Ie<_e.length;Ie++)ve=(be.words[Ie]|0)-(_e.words[Ie]|0)+Me,Me=ve>>26,this.words[Ie]=ve&67108863;for(;Me!==0&&Ie<be.length;Ie++)ve=(be.words[Ie]|0)+Me,Me=ve>>26,this.words[Ie]=ve&67108863;if(Me===0&&Ie<be.length&&be!==this)for(;Ie<be.length;Ie++)this.words[Ie]=be.words[Ie];return this.length=Math.max(this.length,Ie),be!==this&&(this.negative=1),this.strip()},te.prototype.sub=function(he){return this.clone().isub(he)};function de(Ae,he,ve){ve.negative=he.negative^Ae.negative;var ye=Ae.length+he.length|0;ve.length=ye,ye=ye-1|0;var be=Ae.words[0]|0,_e=he.words[0]|0,Me=be*_e,Ie=Me&67108863,Fe=Me/67108864|0;ve.words[0]=Ie;for(var Ee=1;Ee<ye;Ee++){for(var ke=Fe>>>26,Ve=Fe&67108863,ze=Math.min(Ee,he.length-1),Ue=Math.max(0,Ee-Ae.length+1);Ue<=ze;Ue++){var Oe=Ee-Ue|0;be=Ae.words[Oe]|0,_e=he.words[Ue]|0,Me=be*_e+Ve,ke+=Me/67108864|0,Ve=Me&67108863}ve.words[Ee]=Ve|0,Fe=ke|0}return Fe!==0?ve.words[Ee]=Fe|0:ve.length--,ve.strip()}var fe=function(he,ve,ye){var be=he.words,_e=ve.words,Me=ye.words,Ie=0,Fe,Ee,ke,Ve=be[0]|0,ze=Ve&8191,Ue=Ve>>>13,Oe=be[1]|0,Dt=Oe&8191,$t=Oe>>>13,Mt=be[2]|0,Kt=Mt&8191,Vt=Mt>>>13,Ht=be[3]|0,$e=Ht&8191,Pe=Ht>>>13,Ne=be[4]|0,We=Ne&8191,Xe=Ne>>>13,Wt=be[5]|0,Ft=Wt&8191,jt=Wt>>>13,ea=be[6]|0,Xt=ea&8191,Yt=ea>>>13,Rt=be[7]|0,Le=Rt&8191,qe=Rt>>>13,Ye=be[8]|0,Ze=Ye&8191,He=Ye>>>13,je=be[9]|0,Ke=je&8191,Ge=je>>>13,Pt=_e[0]|0,Gt=Pt&8191,Zt=Pt>>>13,aa=_e[1]|0,ta=aa&8191,ia=aa>>>13,oa=_e[2]|0,na=oa&8191,ra=oa>>>13,la=_e[3]|0,sa=la&8191,ca=la>>>13,Sa=_e[4]|0,ha=Sa&8191,ma=Sa>>>13,Ta=_e[5]|0,va=Ta&8191,ga=Ta>>>13,ka=_e[6]|0,ya=ka&8191,pa=ka>>>13,Ea=_e[7]|0,Da=Ea&8191,ba=Ea>>>13,Fa=_e[8]|0,Aa=Fa&8191,Qt=Fa>>>13,da=_e[9]|0,ua=da&8191,fa=da>>>13;ye.negative=he.negative^ve.negative,ye.length=19,Fe=Math.imul(ze,Gt),Ee=Math.imul(ze,Zt),Ee=Ee+Math.imul(Ue,Gt)|0,ke=Math.imul(Ue,Zt);var xa=(Ie+Fe|0)+((Ee&8191)<<13)|0;Ie=(ke+(Ee>>>13)|0)+(xa>>>26)|0,xa&=67108863,Fe=Math.imul(Dt,Gt),Ee=Math.imul(Dt,Zt),Ee=Ee+Math.imul($t,Gt)|0,ke=Math.imul($t,Zt),Fe=Fe+Math.imul(ze,ta)|0,Ee=Ee+Math.imul(ze,ia)|0,Ee=Ee+Math.imul(Ue,ta)|0,ke=ke+Math.imul(Ue,ia)|0;var wa=(Ie+Fe|0)+((Ee&8191)<<13)|0;Ie=(ke+(Ee>>>13)|0)+(wa>>>26)|0,wa&=67108863,Fe=Math.imul(Kt,Gt),Ee=Math.imul(Kt,Zt),Ee=Ee+Math.imul(Vt,Gt)|0,ke=Math.imul(Vt,Zt),Fe=Fe+Math.imul(Dt,ta)|0,Ee=Ee+Math.imul(Dt,ia)|0,Ee=Ee+Math.imul($t,ta)|0